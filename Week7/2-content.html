<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>content – BSSC0021</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/stat_bear.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-e1ddcd3af2ec4b57c0db9e416c98bed6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-sm " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../assets/stat_bear.png" alt="BSSC0021" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../office-hours.html"> 
<span class="menu-text">Office Hours</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../notes.html"> 
<span class="menu-text">Weekly Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html"> 
<span class="menu-text">Lecture Slides</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://rstudio.data-science.rc.ucl.ac.uk/" title="" class="quarto-navigation-tool px-1" aria-label="RStudio"><i class="bi bi-r-circle-fill"></i></a>
    <a href="https://github.com/MitchellAcoustics/BSSC0021-Code" title="" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#anova-and-extended-applications-of-linear-models" id="toc-anova-and-extended-applications-of-linear-models" class="nav-link active" data-scroll-target="#anova-and-extended-applications-of-linear-models">ANOVA and Extended Applications of Linear Models</a>
  <ul class="collapse">
<li><a href="#extending-the-general-linear-model-framework" id="toc-extending-the-general-linear-model-framework" class="nav-link" data-scroll-target="#extending-the-general-linear-model-framework">Extending the General Linear Model Framework</a></li>
  <li><a href="#unifying-statistical-tests-summary-table" id="toc-unifying-statistical-tests-summary-table" class="nav-link" data-scroll-target="#unifying-statistical-tests-summary-table">Unifying Statistical Tests: Summary Table</a></li>
  <li><a href="#anova-comparing-multiple-groups" id="toc-anova-comparing-multiple-groups" class="nav-link" data-scroll-target="#anova-comparing-multiple-groups">ANOVA: Comparing Multiple Groups</a></li>
  <li><a href="#fuel-consumption-dataset" id="toc-fuel-consumption-dataset" class="nav-link" data-scroll-target="#fuel-consumption-dataset">Fuel Consumption Dataset</a></li>
  <li><a href="#one-way-anova-traditional-approach" id="toc-one-way-anova-traditional-approach" class="nav-link" data-scroll-target="#one-way-anova-traditional-approach">One-way ANOVA: Traditional Approach</a></li>
  <li><a href="#one-way-anova-as-linear-model" id="toc-one-way-anova-as-linear-model" class="nav-link" data-scroll-target="#one-way-anova-as-linear-model">One-way ANOVA as Linear Model</a></li>
  <li><a href="#understanding-the-linear-model-coefficients" id="toc-understanding-the-linear-model-coefficients" class="nav-link" data-scroll-target="#understanding-the-linear-model-coefficients">Understanding the Linear Model Coefficients</a></li>
  <li><a href="#visualizing-the-anova-results" id="toc-visualizing-the-anova-results" class="nav-link" data-scroll-target="#visualizing-the-anova-results">Visualizing the ANOVA Results</a></li>
  <li><a href="#two-way-anova-adding-another-factor" id="toc-two-way-anova-adding-another-factor" class="nav-link" data-scroll-target="#two-way-anova-adding-another-factor">Two-way ANOVA: Adding Another Factor</a></li>
  <li><a href="#adding-interaction-effects" id="toc-adding-interaction-effects" class="nav-link" data-scroll-target="#adding-interaction-effects">Adding Interaction Effects</a></li>
  <li><a href="#visualizing-the-interaction" id="toc-visualizing-the-interaction" class="nav-link" data-scroll-target="#visualizing-the-interaction">Visualizing the Interaction</a></li>
  <li><a href="#ancova-mixing-categorical-and-continuous-predictors" id="toc-ancova-mixing-categorical-and-continuous-predictors" class="nav-link" data-scroll-target="#ancova-mixing-categorical-and-continuous-predictors">ANCOVA: Mixing Categorical and Continuous Predictors</a></li>
  <li><a href="#effect-sizes-understanding-practical-significance" id="toc-effect-sizes-understanding-practical-significance" class="nav-link" data-scroll-target="#effect-sizes-understanding-practical-significance">Effect Sizes: Understanding Practical Significance</a></li>
  <li><a href="#post-hoc-tests-which-groups-differ" id="toc-post-hoc-tests-which-groups-differ" class="nav-link" data-scroll-target="#post-hoc-tests-which-groups-differ">Post-hoc Tests: Which Groups Differ?</a></li>
  <li><a href="#pearson-and-spearman-correlation-as-linear-models" id="toc-pearson-and-spearman-correlation-as-linear-models" class="nav-link" data-scroll-target="#pearson-and-spearman-correlation-as-linear-models">Pearson and Spearman Correlation as Linear Models</a></li>
  <li><a href="#pearson-vs.-spearman-correlation" id="toc-pearson-vs.-spearman-correlation" class="nav-link" data-scroll-target="#pearson-vs.-spearman-correlation">Pearson vs.&nbsp;Spearman Correlation</a></li>
  <li><a href="#correlation-visualized" id="toc-correlation-visualized" class="nav-link" data-scroll-target="#correlation-visualized">Correlation Visualized</a></li>
  <li><a href="#non-parametric-tests-just-ranked-versions-of-parametric-tests" id="toc-non-parametric-tests-just-ranked-versions-of-parametric-tests" class="nav-link" data-scroll-target="#non-parametric-tests-just-ranked-versions-of-parametric-tests">Non-parametric Tests: Just Ranked Versions of Parametric Tests</a></li>
  <li><a href="#integrated-example-hr-analytics-with-anova" id="toc-integrated-example-hr-analytics-with-anova" class="nav-link" data-scroll-target="#integrated-example-hr-analytics-with-anova">Integrated Example: HR Analytics with ANOVA</a></li>
  <li><a href="#visualizing-hr-department-differences" id="toc-visualizing-hr-department-differences" class="nav-link" data-scroll-target="#visualizing-hr-department-differences">Visualizing HR Department Differences</a></li>
  <li><a href="#combining-anova-and-regression" id="toc-combining-anova-and-regression" class="nav-link" data-scroll-target="#combining-anova-and-regression">Combining ANOVA and Regression</a></li>
  <li><a href="#beyond-the-basics-generalized-linear-models" id="toc-beyond-the-basics-generalized-linear-models" class="nav-link" data-scroll-target="#beyond-the-basics-generalized-linear-models">Beyond The Basics: Generalized Linear Models</a></li>
  <li><a href="#practical-code-cheat-sheet" id="toc-practical-code-cheat-sheet" class="nav-link" data-scroll-target="#practical-code-cheat-sheet">Practical Code Cheat Sheet</a></li>
  <li><a href="#the-power-of-the-unified-approach" id="toc-the-power-of-the-unified-approach" class="nav-link" data-scroll-target="#the-power-of-the-unified-approach">The Power of the Unified Approach</a></li>
  <li><a href="#practical-implications-of-the-glm-framework" id="toc-practical-implications-of-the-glm-framework" class="nav-link" data-scroll-target="#practical-implications-of-the-glm-framework">Practical Implications of the GLM Framework</a></li>
  <li><a href="#concluding-thoughts" id="toc-concluding-thoughts" class="nav-link" data-scroll-target="#concluding-thoughts">Concluding Thoughts</a></li>
  </ul>
</li>
  </ul><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2-content.pdf"><i class="bi bi-file-pdf"></i>Typst</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header><section id="anova-and-extended-applications-of-linear-models" class="level1" data-background-color="#1E3D59"><h1 data-background-color="#1E3D59">ANOVA and Extended Applications of Linear Models</h1>
<section id="extending-the-general-linear-model-framework" class="level2"><h2 class="anchored" data-anchor-id="extending-the-general-linear-model-framework">Extending the General Linear Model Framework</h2>
<p>Having established the basic GLM framework and seen how t-tests and multiple regression are special cases, we’ll now explore:</p>
<ol type="1">
<li>
<strong>Analysis of Variance (ANOVA)</strong> as an extension of the linear model</li>
<li>
<strong>Correlation techniques</strong> expressed as linear models</li>
<li>
<strong>Non-parametric tests</strong> as transformations of parametric tests</li>
<li>
<strong>Practical code implementations</strong> showing the equivalences</li>
</ol>
<p>These applications further demonstrate the power of the unified statistical framework.</p>
<div class="notes">
<p>Now that we’ve established how the General Linear Model provides a unified framework for basic statistical tests like t-tests and simple regression, we’ll extend our exploration to more complex applications.</p>
<p>In this section, we’ll see how ANOVA, which is traditionally taught as a separate technique, is actually just another manifestation of the linear model. We’ll also explore correlation methods, non-parametric alternatives, and practical code implementations.</p>
<p>By continuing to build on the GLM framework, we reinforce the idea that these seemingly different statistical procedures are variations on the same underlying theme. This approach not only simplifies learning but also enables more flexible and sophisticated statistical modeling.</p>
</div>
</section><section id="unifying-statistical-tests-summary-table" class="level2"><h2 class="anchored" data-anchor-id="unifying-statistical-tests-summary-table">Unifying Statistical Tests: Summary Table</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 31%">
<col style="width: 39%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Linear Model Formula</th>
<th style="text-align: left;">What’s being tested</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Correlation</td>
<td style="text-align: left;">y ~ x</td>
<td style="text-align: left;">Slope coefficient</td>
</tr>
<tr class="even">
<td style="text-align: left;">One-sample t-test</td>
<td style="text-align: left;">y ~ 1</td>
<td style="text-align: left;">Intercept</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Independent t-test</td>
<td style="text-align: left;">y ~ group</td>
<td style="text-align: left;">Group coefficient</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paired t-test</td>
<td style="text-align: left;">diff ~ 1</td>
<td style="text-align: left;">Intercept of differences</td>
</tr>
<tr class="odd">
<td style="text-align: left;">One-way ANOVA</td>
<td style="text-align: left;">y ~ group</td>
<td style="text-align: left;">Group coefficients</td>
</tr>
<tr class="even">
<td style="text-align: left;">Two-way ANOVA</td>
<td style="text-align: left;">y ~ factorA * factorB</td>
<td style="text-align: left;">Main effects &amp; interaction</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Multiple regression</td>
<td style="text-align: left;">y ~ x1 + x2 + …</td>
<td style="text-align: left;">Multiple coefficients</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Key insights from this table:</strong></p>
<ul>
<li>Each common test has a corresponding linear model formulation</li>
<li>Many tests share the same model structure but test different coefficients</li>
<li>Understanding the pattern makes it easier to apply the right test for your research question</li>
</ul>
<div class="notes">
<p>This table summarizes how different common tests map to linear model formulations. For each test, we can identify what linear model would be equivalent and which coefficient(s) we’re testing.</p>
<p>Notice that the difference between tests often comes down to:</p>
<ol type="1">
<li>What variables we include in the model</li>
<li>Which coefficient(s) we’re interested in testing</li>
<li>How we interpret the results</li>
</ol>
<p>This unified framework helps students see that they’re not learning completely different procedures for each test, but rather applying the same underlying model in different contexts.</p>
<p>The table serves as a reference guide that students can use when deciding which statistical approach to use for their research questions. It emphasizes that the choice of test is about identifying the appropriate model structure for the research question, rather than selecting from an unrelated menu of statistical options.</p>
</div>
</section><section id="anova-comparing-multiple-groups" class="level2"><h2 class="anchored" data-anchor-id="anova-comparing-multiple-groups">ANOVA: Comparing Multiple Groups</h2>
<p>ANOVA (Analysis of Variance) is traditionally taught as a distinct statistical test for comparing means across multiple groups.</p>
<div class="incremental">
<ul class="incremental">
<li>Null hypothesis: All group means are equal (<span class="math inline">\mu_1 = \mu_2 = ... = \mu_k</span>)</li>
<li>Alternative hypothesis: At least one group mean differs from the others</li>
<li>Test statistic: F-ratio (ratio of between-group to within-group variance)</li>
</ul>
</div>
<div class="notes">
<p>ANOVA is traditionally taught as a distinct test from regression, with its own set of formulas and concepts like “sums of squares” and “F-ratios.” However, ANOVA is actually just another manifestation of the general linear model.</p>
<p>The key insight is that when we compare means across groups, we’re essentially predicting an outcome (y) based on group membership (a categorical variable). This can be seamlessly represented within the linear model framework.</p>
</div>
</section><section id="fuel-consumption-dataset" class="level2"><h2 class="anchored" data-anchor-id="fuel-consumption-dataset">Fuel Consumption Dataset</h2>
<p>Let’s use a real dataset on fuel consumption in Canada to demonstrate ANOVA as a linear model.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># View the structure of the fuel consumption dataset</span></span>
<span><span class="va">fuel_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">make</span>, <span class="va">model</span>, <span class="va">class</span>, <span class="va">enginesize</span>, <span class="va">cylinders468</span>, <span class="va">fueluseboth</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">make</th>
<th style="text-align: left;">model</th>
<th style="text-align: left;">class</th>
<th style="text-align: right;">enginesize</th>
<th style="text-align: right;">cylinders468</th>
<th style="text-align: right;">fueluseboth</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ACURA</td>
<td style="text-align: left;">ILX</td>
<td style="text-align: left;">COMPACT</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">ACURA</td>
<td style="text-align: left;">ILX</td>
<td style="text-align: left;">COMPACT</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">9.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACURA</td>
<td style="text-align: left;">ILX HYBRID</td>
<td style="text-align: left;">COMPACT</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ACURA</td>
<td style="text-align: left;">MDX SH-AWD</td>
<td style="text-align: left;">SUV - SMALL</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">11.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACURA</td>
<td style="text-align: left;">RDX AWD</td>
<td style="text-align: left;">SUV - SMALL</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">10.6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="notes">
<p>This dataset contains information about vehicles sold in Canada, including their fuel consumption (measured in liters per 100 kilometers), engine characteristics, and vehicle class.</p>
<p>We’ll use this data to compare average fuel consumption across different vehicle classes, first using traditional ANOVA and then showing the equivalent linear model approach.</p>
</div>
</section><section id="one-way-anova-traditional-approach" class="level2"><h2 class="anchored" data-anchor-id="one-way-anova-traditional-approach">One-way ANOVA: Traditional Approach</h2>
<p>Let’s compare fuel consumption across vehicle classes:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Run traditional ANOVA</span></span>
<span><span class="va">anova_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">fueluseboth</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">fuel_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>              Df Sum Sq Mean Sq F value Pr(&gt;F)    
class         14   4099  292.78   62.77 &lt;2e-16 ***
Residuals   1067   4977    4.66                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The significant p-value (&lt; 0.05) indicates that average fuel consumption differs significantly across vehicle classes.</p>
<div class="notes">
<p>The traditional ANOVA output shows us the familiar ANOVA table with sums of squares, degrees of freedom, mean squares, and the F-statistic. The very small p-value tells us that there are significant differences in fuel consumption between vehicle classes.</p>
<p>But how does this relate to the linear model? Let’s see.</p>
</div>
</section><section id="one-way-anova-as-linear-model" class="level2"><h2 class="anchored" data-anchor-id="one-way-anova-as-linear-model">One-way ANOVA as Linear Model</h2>
<p>The same analysis using the linear model approach:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Run equivalent linear model</span></span>
<span><span class="va">lm_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fueluseboth</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">fuel_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm_result</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: fueluseboth
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
class       14 4098.9 292.775  62.772 &lt; 2.2e-16 ***
Residuals 1067 4976.6   4.664                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Notice the identical F-value and p-value as the traditional ANOVA!</p>
<div class="notes">
<p>When we run the same analysis using lm() instead of aov(), and then use anova() on the result, we get the exact same F-value and p-value as the traditional ANOVA. That’s because they’re mathematically equivalent - ANOVA is just a linear model with categorical predictors.</p>
<p>In this linear model, we’re predicting fuel consumption based on vehicle class. The model creates dummy variables for each vehicle class (except one, which serves as the reference group).</p>
</div>
</section><section id="understanding-the-linear-model-coefficients" class="level2"><h2 class="anchored" data-anchor-id="understanding-the-linear-model-coefficients">Understanding the Linear Model Coefficients</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># View coefficients from the linear model</span></span>
<span><span class="fu">tidy</span><span class="op">(</span><span class="va">lm_result</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 44%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">9.355</td>
<td style="text-align: right;">0.162</td>
<td style="text-align: right;">57.792</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">classFULL-SIZE</td>
<td style="text-align: right;">2.504</td>
<td style="text-align: right;">0.285</td>
<td style="text-align: right;">8.793</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">classMID-SIZE</td>
<td style="text-align: right;">0.279</td>
<td style="text-align: right;">0.229</td>
<td style="text-align: right;">1.220</td>
<td style="text-align: right;">0.223</td>
</tr>
<tr class="even">
<td style="text-align: left;">classMINICOMPACT</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.329</td>
<td style="text-align: right;">2.272</td>
<td style="text-align: right;">0.023</td>
</tr>
<tr class="odd">
<td style="text-align: left;">classMINIVAN</td>
<td style="text-align: right;">2.925</td>
<td style="text-align: right;">0.581</td>
<td style="text-align: right;">5.037</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">classPICKUP TRUCK - SMALL</td>
<td style="text-align: right;">2.531</td>
<td style="text-align: right;">0.488</td>
<td style="text-align: right;">5.186</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">classPICKUP TRUCK - STANDARD</td>
<td style="text-align: right;">4.905</td>
<td style="text-align: right;">0.340</td>
<td style="text-align: right;">14.407</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">classSPECIAL PURPOSE VEHICLE</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">0.738</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.320</td>
</tr>
<tr class="odd">
<td style="text-align: left;">classSTATION WAGON - MID-SIZE</td>
<td style="text-align: right;">0.359</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">0.432</td>
<td style="text-align: right;">0.666</td>
</tr>
<tr class="even">
<td style="text-align: left;">classSTATION WAGON - SMALL</td>
<td style="text-align: right;">-0.774</td>
<td style="text-align: right;">0.415</td>
<td style="text-align: right;">-1.866</td>
<td style="text-align: right;">0.062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">classSUBCOMPACT</td>
<td style="text-align: right;">0.951</td>
<td style="text-align: right;">0.284</td>
<td style="text-align: right;">3.352</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">classSUV - SMALL</td>
<td style="text-align: right;">1.038</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">4.495</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">classSUV - STANDARD</td>
<td style="text-align: right;">4.497</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">16.610</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">classTWO-SEATER</td>
<td style="text-align: right;">1.575</td>
<td style="text-align: right;">0.303</td>
<td style="text-align: right;">5.194</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">classVAN - PASSENGER</td>
<td style="text-align: right;">10.466</td>
<td style="text-align: right;">0.521</td>
<td style="text-align: right;">20.079</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Interpretation: - The intercept (9.171) is the mean fuel consumption for the reference class (COMPACT) - Each coefficient represents the difference between that class and the reference class - E.g., FULL-SIZE vehicles consume 3.514 L/100km more fuel than COMPACT vehicles, on average</p>
<div class="notes">
<p>Looking at the coefficients from the linear model gives us more detailed information than the ANOVA table alone. The intercept represents the mean fuel consumption for the reference group (in this case, COMPACT vehicles).</p>
<p>Each other coefficient represents the difference in mean fuel consumption between that vehicle class and the reference class. For example, the coefficient for classFULL-SIZE is 3.514, which means that, on average, full-size vehicles consume 3.514 liters per 100km more fuel than compact vehicles.</p>
<p>This is a much more detailed result than the overall ANOVA, which only tells us that there are differences somewhere. The linear model pinpoints exactly where those differences are.</p>
</div>
</section><section id="visualizing-the-anova-results" class="level2"><h2 class="anchored" data-anchor-id="visualizing-the-anova-results">Visualizing the ANOVA Results</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a visualization of group means</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">fuel_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">class</span>, y <span class="op">=</span> <span class="va">fueluseboth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Vehicle Class"</span>, y <span class="op">=</span> <span class="st">"Fuel Consumption (L/100km)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Fuel Consumption by Vehicle Class"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="2-content_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>This visualization helps us see the differences in fuel consumption across vehicle classes. We can visually confirm that larger vehicle classes like full-size, SUV, and pickup trucks tend to have higher fuel consumption than compact and subcompact vehicles.</p>
<p>The boxplots show the median (middle line), quartiles (box), and range (whiskers) of fuel consumption for each class, while the individual points represent actual vehicles in the dataset.</p>
</div>
</section><section id="two-way-anova-adding-another-factor" class="level2"><h2 class="anchored" data-anchor-id="two-way-anova-adding-another-factor">Two-way ANOVA: Adding Another Factor</h2>
<p>Let’s extend our model to include the number of cylinders468:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a simplified cylinder factor</span></span>
<span><span class="va">fuel_data</span> <span class="op">&lt;-</span> <span class="va">fuel_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cyl_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">cylinders468</span> <span class="op">&lt;=</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"4 or fewer"</span>,</span>
<span>    <span class="va">cylinders468</span> <span class="op">==</span> <span class="fl">6</span> <span class="op">~</span> <span class="st">"6"</span>,</span>
<span>    <span class="va">cylinders468</span> <span class="op">&gt;=</span> <span class="fl">8</span> <span class="op">~</span> <span class="st">"8 or more"</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run two-way ANOVA</span></span>
<span><span class="va">two_way_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fueluseboth</span> <span class="op">~</span> <span class="va">class</span> <span class="op">+</span> <span class="va">cyl_factor</span>, data <span class="op">=</span> <span class="va">fuel_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">two_way_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: fueluseboth
             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
class        14 4098.9  292.78  131.26 &lt; 2.2e-16 ***
cyl_factor    2 2601.1 1300.53  583.05 &lt; 2.2e-16 ***
Residuals  1065 2375.6    2.23                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Both vehicle class and number of cylinders468 significantly affect fuel consumption.</p>
<div class="notes">
<p>Here we’ve extended our model to include two factors: vehicle class and number of cylinders468. This is called a two-way ANOVA in traditional statistics.</p>
<p>The ANOVA table shows that both factors have significant effects on fuel consumption. In other words, fuel consumption varies significantly based on both vehicle class and number of cylinders468.</p>
<p>But this model only looks at the main effects - it doesn’t consider interactions between the factors.</p>
</div>
</section><section id="adding-interaction-effects" class="level2"><h2 class="anchored" data-anchor-id="adding-interaction-effects">Adding Interaction Effects</h2>
<p>In the linear model framework, interactions are easy to add:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Run two-way ANOVA with interaction</span></span>
<span><span class="va">interaction_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fueluseboth</span> <span class="op">~</span> <span class="va">class</span> <span class="op">*</span> <span class="va">cyl_factor</span>, data <span class="op">=</span> <span class="va">fuel_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">interaction_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: fueluseboth
                   Df Sum Sq Mean Sq  F value  Pr(&gt;F)    
class              14 4098.9  292.78 133.0732 &lt; 2e-16 ***
cyl_factor          2 2601.1 1300.53 591.1207 &lt; 2e-16 ***
class:cyl_factor   21   78.7    3.75   1.7024 0.02506 *  
Residuals        1044 2296.9    2.20                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The interaction term tests whether the effect of one factor depends on the level of the other factor.</p>
<div class="notes">
<p>An interaction effect occurs when the effect of one factor depends on the level of another factor. For example, the difference in fuel consumption between 4-cylinder and 8-cylinder engines might be larger for SUVs than for compact cars.</p>
<p>In the linear model, we can easily test for interactions by using the * operator instead of +. This adds both main effects and their interaction.</p>
<p>The ANOVA table shows a significant interaction effect, indicating that the effect of cylinders468 on fuel consumption differs across vehicle classes (or equivalently, the effect of vehicle class differs depending on the number of cylinders468).</p>
</div>
</section><section id="visualizing-the-interaction" class="level2"><h2 class="anchored" data-anchor-id="visualizing-the-interaction">Visualizing the Interaction</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create an interaction plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">fuel_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">class</span>, y <span class="op">=</span> <span class="va">fueluseboth</span>, fill <span class="op">=</span> <span class="va">cyl_factor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Vehicle Class"</span>, y <span class="op">=</span> <span class="st">"Average Fuel Consumption (L/100km)"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Cylinders"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Interaction between Vehicle Class and Engine Cylinders"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="2-content_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>This bar chart helps visualize the interaction effect. Each group of bars represents a vehicle class, and the different colored bars within each group represent different cylinder categories.</p>
<p>If there were no interaction, the pattern of differences between cylinder categories would be consistent across all vehicle classes. The fact that the pattern varies - for example, the difference between 4-cylinder and 8-cylinder engines seems larger for some vehicle classes than others - illustrates the interaction effect.</p>
<p>This is a powerful aspect of the general linear model: it allows us to model and interpret complex relationships between variables, including interactions.</p>
</div>
</section><section id="ancova-mixing-categorical-and-continuous-predictors" class="level2"><h2 class="anchored" data-anchor-id="ancova-mixing-categorical-and-continuous-predictors">ANCOVA: Mixing Categorical and Continuous Predictors</h2>
<p>ANCOVA (Analysis of Covariance) combines ANOVA with regression by including both categorical and continuous predictors:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Run ANCOVA</span></span>
<span><span class="va">ancova_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fueluseboth</span> <span class="op">~</span> <span class="va">class</span> <span class="op">+</span> <span class="va">enginesize</span>, data <span class="op">=</span> <span class="va">fuel_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ancova_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = fueluseboth ~ class + enginesize, data = fuel_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.2020 -0.7662 -0.1031  0.5934  6.5633 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    5.70095    0.15343  37.156  &lt; 2e-16 ***
classFULL-SIZE                 0.53708    0.20372   2.636 0.008500 ** 
classMID-SIZE                 -0.45814    0.15871  -2.887 0.003972 ** 
classMINICOMPACT              -0.05542    0.22699  -0.244 0.807157    
classMINIVAN                   1.56351    0.40083   3.901 0.000102 ***
classPICKUP TRUCK - SMALL      1.49943    0.33662   4.454 9.30e-06 ***
classPICKUP TRUCK - STANDARD   1.77451    0.25079   7.076 2.69e-12 ***
classSPECIAL PURPOSE VEHICLE   0.87872    0.50691   1.733 0.083302 .  
classSTATION WAGON - MID-SIZE -0.62622    0.57240  -1.094 0.274190    
classSTATION WAGON - SMALL    -0.02474    0.28570  -0.087 0.931013    
classSUBCOMPACT                0.25683    0.19587   1.311 0.190059    
classSUV - SMALL               0.79530    0.15879   5.009 6.41e-07 ***
classSUV - STANDARD            1.68690    0.20301   8.310 2.89e-16 ***
classTWO-SEATER                0.30611    0.21146   1.448 0.148023    
classVAN - PASSENGER           6.11458    0.37956  16.110  &lt; 2e-16 ***
enginesize                     1.48977    0.04310  34.567  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.484 on 1066 degrees of freedom
Multiple R-squared:  0.7414,    Adjusted R-squared:  0.7378 
F-statistic: 203.8 on 15 and 1066 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>This model predicts fuel consumption based on both vehicle class (categorical) and engine size (continuous).</p>
<div class="notes">
<p>ANCOVA is traditionally taught as yet another distinct technique, but in the general linear model framework, it’s simply a model that includes both categorical and continuous predictors.</p>
<p>In this model, we’re predicting fuel consumption based on vehicle class and engine size. The coefficients for vehicle class represent the differences between classes after controlling for engine size. The coefficient for engine size represents the effect of engine size on fuel consumption, controlling for vehicle class.</p>
<p>This is another example of how the general linear model provides a unified framework for various statistical techniques.</p>
</div>
</section><section id="effect-sizes-understanding-practical-significance" class="level2"><h2 class="anchored" data-anchor-id="effect-sizes-understanding-practical-significance">Effect Sizes: Understanding Practical Significance</h2>
<p>Statistical significance (p-values) tells us if effects are likely real, but effect sizes tell us if they’re practically important:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate effect sizes</span></span>
<span><span class="fu">eta_squared</span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Eta2 |       95% CI
-------------------------------
class     | 0.45 | [0.41, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Interpretation:</p>
<ul>
<li>η² = proportion of variance explained by each factor</li>
<li>Vehicle class explains about 43% of the variance in fuel consumption</li>
<li>Values of 0.01, 0.06, and 0.14 are considered small, medium, and large effects</li>
</ul>
<div class="notes">
<p>While p-values tell us whether an effect is statistically significant (unlikely to be due to chance), effect sizes tell us about the practical significance or magnitude of the effect.</p>
<p>For ANOVA, a common effect size is eta-squared (η²), which represents the proportion of variance explained by each factor. Values around 0.01 are considered small, 0.06 medium, and 0.14 large.</p>
<p>The eta-squared value of 0.43 for vehicle class indicates that about 43% of the variance in fuel consumption is explained by vehicle class, which is a very large effect.</p>
<p>Effect sizes are important because with large enough sample sizes, even tiny, practically meaningless effects can become statistically significant.</p>
</div>
</section><section id="post-hoc-tests-which-groups-differ" class="level2"><h2 class="anchored" data-anchor-id="post-hoc-tests-which-groups-differ">Post-hoc Tests: Which Groups Differ?</h2>
<p>When ANOVA finds significant differences, post-hoc tests help identify which specific groups differ:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate estimated marginal means</span></span>
<span><span class="va">emm</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">lm_result</span>, <span class="op">~</span><span class="va">class</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pairwise comparisons with Tukey adjustment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">emm</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">p.value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 52%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">COMPACT - (PICKUP TRUCK - STANDARD)</td>
<td style="text-align: right;">-4.905</td>
<td style="text-align: right;">0.340</td>
<td style="text-align: right;">1067</td>
<td style="text-align: right;">-14.407</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">COMPACT - (SUV - STANDARD)</td>
<td style="text-align: right;">-4.497</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">1067</td>
<td style="text-align: right;">-16.610</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">COMPACT - (VAN - PASSENGER)</td>
<td style="text-align: right;">-10.466</td>
<td style="text-align: right;">0.521</td>
<td style="text-align: right;">1067</td>
<td style="text-align: right;">-20.079</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">(FULL-SIZE) - (VAN - PASSENGER)</td>
<td style="text-align: right;">-7.962</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">1067</td>
<td style="text-align: right;">-14.528</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(MID-SIZE) - (PICKUP TRUCK - STANDARD)</td>
<td style="text-align: right;">-4.625</td>
<td style="text-align: right;">0.340</td>
<td style="text-align: right;">1067</td>
<td style="text-align: right;">-13.586</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="notes">
<p>When ANOVA indicates significant differences between groups, we often want to know which specific groups differ from each other. Post-hoc tests help answer this question.</p>
<p>Here we’re using estimated marginal means and pairwise comparisons with Tukey’s adjustment for multiple comparisons. The results show the estimated difference between each pair of vehicle classes, along with confidence intervals and adjusted p-values.</p>
<p>The table shows the 5 most significant pairwise differences. For example, fuel consumption differs significantly between SUV-UTILITY and COMPACT-SUV vehicle classes.</p>
<p>This is another example of how the linear model framework provides a comprehensive approach to statistical analysis, from overall tests to detailed comparisons.</p>
</div>
</section><section id="pearson-and-spearman-correlation-as-linear-models" class="level2"><h2 class="anchored" data-anchor-id="pearson-and-spearman-correlation-as-linear-models">Pearson and Spearman Correlation as Linear Models</h2>
<p>Model: <span class="math inline">y = \beta_0 + \beta_1 x \quad</span> where <span class="math inline">\mathcal{H}_0: \beta_1 = 0</span></p>
<p>This is simply a linear regression with one predictor. When we test whether the correlation is significant, we’re testing whether the slope (<span class="math inline">\beta_1</span>) differs from zero.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Traditional correlation</span></span>
<span><span class="va">cor_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, <span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">cor_result</span><span class="op">$</span><span class="va">estimate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      cor 
0.5818111 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cor_result</span><span class="op">$</span><span class="va">p.value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 9.360699e-06</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># As linear model (standardized variables)</span></span>
<span><span class="va">lm_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_cor</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co"># slope = correlation coefficient</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> scale(x) 
0.5818111 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_cor</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"Pr(&gt;|t|)"</span><span class="op">]</span> <span class="co"># p-value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 9.360699e-06</code></pre>
</div>
</div>
<p>When we standardize both variables (giving them mean=0 and sd=1), the slope coefficient equals the correlation coefficient!</p>
</div>
</div>
<div class="notes">
<p>Here we demonstrate that Pearson’s correlation is equivalent to the standardized regression coefficient in a simple linear regression model.</p>
<p>The mathematical model is exactly the same as simple linear regression: y = β₀ + β₁x + ε. The null hypothesis being tested is that β₁ = 0, which means there is no linear relationship between the variables.</p>
<p>When we standardize both x and y (to have mean=0 and sd=1), the slope coefficient in a linear regression equals the correlation coefficient r. This makes intuitive sense because standardization puts both variables on the same scale, making their relationship directly comparable.</p>
<p>The t-test on this coefficient tests exactly the same hypothesis as the correlation test: is there a linear relationship between the variables? The p-values are identical between the two approaches.</p>
</div>
</section><section id="pearson-vs.-spearman-correlation" class="level2"><h2 class="anchored" data-anchor-id="pearson-vs.-spearman-correlation">Pearson vs.&nbsp;Spearman Correlation</h2>
<p>Spearman correlation is Pearson correlation on rank-transformed variables:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Pearson correlation on original data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5818111</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Spearman correlation = Pearson on ranks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6436975</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Same as Pearson correlation on ranked variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6436975</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># As linear model with ranks</span></span>
<span><span class="va">lm_spearman</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_spearman</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"Estimate"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6436975</code></pre>
</div>
</div>
<p>The “non-parametric” Spearman correlation is simply the “parametric” Pearson correlation applied to ranked data!</p>
<div class="notes">
<p>Spearman’s rank correlation is a brilliant example of how a “non-parametric” test is simply a parametric test applied to transformed data.</p>
<p>Instead of correlating the original values, Spearman correlation first converts all values to their ranks (1st, 2nd, 3rd, etc.) and then applies the Pearson correlation formula to these ranks.</p>
<p>This transformation accomplishes two things:</p>
<ol type="1">
<li>It makes the test robust to outliers, since extreme values just become the highest or lowest rank</li>
<li>It allows the test to detect monotonic but non-linear relationships, since ranking linearizes any monotonic relationship</li>
</ol>
<p>By understanding Spearman correlation as “Pearson on ranks,” we demystify non-parametric statistics. Many so-called non-parametric tests are simply parametric tests applied to transformed data, making them more accessible conceptually.</p>
</div>
</section><section id="correlation-visualized" class="level2"><h2 class="anchored" data-anchor-id="correlation-visualized">Correlation Visualized</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Pearson: Original Values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rank_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x_rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, y_rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">rank_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_rank</span>, y <span class="op">=</span> <span class="va">y_rank</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Spearman: Ranked Values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="2-content_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Left: Pearson correlation fits a line to the original data points<br>
Right: Spearman correlation fits a line to the ranked data points</p>
<div class="notes">
<p>This visualization helps us understand the relationship between Pearson and Spearman correlation.</p>
<p>The left panel shows the original data with the regression line (Pearson’s r). The right panel shows the same data after converting to ranks, with its regression line (Spearman’s rho).</p>
<p>Notice how the ranked data (right panel) tends to form a more linear pattern. This is because ranking removes the influence of outliers and transforms any monotonic relationship into a linear one.</p>
<p>Another key insight: the slope of the line through the ranked data is the Spearman correlation coefficient, just as the slope of the line through the standardized original data is the Pearson correlation coefficient.</p>
</div>
</section><section id="non-parametric-tests-just-ranked-versions-of-parametric-tests" class="level2"><h2 class="anchored" data-anchor-id="non-parametric-tests-just-ranked-versions-of-parametric-tests">Non-parametric Tests: Just Ranked Versions of Parametric Tests</h2>
<p>For many common “non-parametric” tests, we can simplify by thinking of them as the parametric equivalent applied to ranks:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 35%">
<col style="width: 36%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Parametric Test</th>
<th style="text-align: left;">Non-parametric Equivalent</th>
<th style="text-align: left;">Transformation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: left;">Spearman correlation</td>
<td style="text-align: left;">Rank both variables</td>
</tr>
<tr class="even">
<td style="text-align: left;">One-sample t-test</td>
<td style="text-align: left;">Wilcoxon signed-rank test</td>
<td style="text-align: left;">Signed rank of values</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Independent t-test</td>
<td style="text-align: left;">Mann-Whitney U test</td>
<td style="text-align: left;">Rank all values</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paired t-test</td>
<td style="text-align: left;">Wilcoxon matched pairs</td>
<td style="text-align: left;">Signed rank of differences</td>
</tr>
<tr class="odd">
<td style="text-align: left;">One-way ANOVA</td>
<td style="text-align: left;">Kruskal-Wallis test</td>
<td style="text-align: left;">Rank all values</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This unified perspective demystifies “non-parametric” statistics:</p>
<ul>
<li>They’re not completely different tests but transformations of familiar ones</li>
<li>Ranking reduces the influence of outliers and nonlinearity</li>
<li>They’re not “assumption-free” but rather make different assumptions</li>
<li>Understanding them as ranked versions of parametric tests makes them easier to grasp</li>
</ul>
<div class="notes">
<p>This table summarizes one of the key insights from our exploration: many “non-parametric” tests can be understood as simple transformations of familiar parametric tests.</p>
<p>For each common parametric test, there’s a corresponding “non-parametric” version that’s essentially the same test applied to ranked data:</p>
<ol type="1">
<li>Spearman correlation is Pearson correlation on ranked variables</li>
<li>Wilcoxon signed-rank test is a one-sample t-test on signed ranks</li>
<li>Mann-Whitney U test is an independent t-test on ranks</li>
<li>Wilcoxon matched pairs test is a paired t-test on signed rank differences</li>
<li>Kruskal-Wallis test is a one-way ANOVA on ranks</li>
</ol>
<p>This perspective offers several benefits: - It demystifies “non-parametric” statistics, making them more accessible - It shows how ranking can make tests more robust to outliers and non-normality - It clarifies that “non-parametric” tests aren’t assumption-free, but make different assumptions - It reduces the number of distinct procedures students need to learn</p>
</div>
</section><section id="integrated-example-hr-analytics-with-anova" class="level2"><h2 class="anchored" data-anchor-id="integrated-example-hr-analytics-with-anova">Integrated Example: HR Analytics with ANOVA</h2>
<p>Let’s return to our HR dataset and use ANOVA to compare job satisfaction across job roles:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load HR Analytics dataset if not already loaded</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html">exists</a></span><span class="op">(</span><span class="st">"hr_data"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">hr_data</span> <span class="op">&lt;-</span> <span class="fu">read_sav</span><span class="op">(</span><span class="st">"data/dataset-abc-insurance-hr-data.sav"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run ANOVA for job satisfaction by department</span></span>
<span><span class="va">hr_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">job_satisfaction</span> <span class="op">~</span> <span class="va">job_role</span>, data <span class="op">=</span> <span class="va">hr_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">hr_anova</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = job_satisfaction ~ job_role, data = hr_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.67123 -0.82659  0.00448  0.83555  2.17341 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.65766    0.06886  38.597  &lt; 2e-16 ***
job_role     0.16893    0.02155   7.839 1.23e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.103 on 934 degrees of freedom
Multiple R-squared:  0.06173,   Adjusted R-squared:  0.06073 
F-statistic: 61.45 on 1 and 934 DF,  p-value: 1.235e-14</code></pre>
</div>
</div>
<div class="notes">
<p>Now let’s apply what we’ve learned to our HR analytics dataset. Here we’re comparing job satisfaction across different job roles using a linear model (which is equivalent to ANOVA).</p>
<p>The results show the mean job satisfaction for the reference role (the intercept) and the differences between each other role and the reference role Some departments appear to have significantly higher or lower job satisfaction than others.</p>
<p>This is a practical application of ANOVA as a linear model in a human resources context.</p>
</div>
</section><section id="visualizing-hr-department-differences" class="level2"><h2 class="anchored" data-anchor-id="visualizing-hr-department-differences">Visualizing HR Department Differences</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a visualization of satisfaction by department</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">hr_data</span>, <span class="fu">aes</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">job_role</span>, <span class="va">job_satisfaction</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="va">job_satisfaction</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Role"</span>, y <span class="op">=</span> <span class="st">"Job Satisfaction (1-5 scale)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Job Satisfaction by Role"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="2-content_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>This visualization helps us see the differences in job satisfaction across departments. The departments are ordered by their mean job satisfaction, with departments having higher average satisfaction appearing towards the right.</p>
<p>We can see variations in both the central tendency (median, indicated by the line in the middle of each box) and the spread of job satisfaction scores within each department.</p>
<p>This kind of analysis could help HR identify departments that might need intervention to improve employee satisfaction, or departments with particularly high satisfaction that might serve as models for others.</p>
</div>
</section><section id="combining-anova-and-regression" class="level2"><h2 class="anchored" data-anchor-id="combining-anova-and-regression">Combining ANOVA and Regression</h2>
<p>We can build more complex models that include: - Multiple categorical predictors (multi-way ANOVA) - Continuous predictors alongside categorical ones (ANCOVA) - Interaction terms between predictors</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Build a complex model</span></span>
<span><span class="va">complex_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">job_satisfaction</span> <span class="op">~</span> <span class="va">job_role</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">evaluation</span> <span class="op">+</span></span>
<span>  <span class="va">job_role</span><span class="op">:</span><span class="va">evaluation</span>, data <span class="op">=</span> <span class="va">hr_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View model summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">complex_model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Mean Sq</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">74.760</td>
<td style="text-align: right;">74.760</td>
<td style="text-align: right;">81.951</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.478</td>
<td style="text-align: right;">1.478</td>
<td style="text-align: right;">1.620</td>
<td style="text-align: right;">0.203</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">285.426</td>
<td style="text-align: right;">285.426</td>
<td style="text-align: right;">312.880</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">0.111</td>
<td style="text-align: right;">0.739</td>
</tr>
<tr class="odd">
<td style="text-align: right;">931</td>
<td style="text-align: right;">849.307</td>
<td style="text-align: right;">0.912</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="notes">
<p>Here we’ve built a more complex model that includes multiple predictors: department (categorical), gender (categorical), and performance rating (continuous), as well as an interaction between department and performance rating.</p>
<p>This model tests whether job satisfaction varies by department, gender, and performance rating, and whether the relationship between performance rating and job satisfaction differs across departments.</p>
<p>The ANOVA table shows which effects are statistically significant. This demonstrates how the general linear model framework allows us to build and test complex models that would be difficult to conceptualize using traditional statistical procedures taught in isolation.</p>
</div>
</section><section id="beyond-the-basics-generalized-linear-models" class="level2"><h2 class="anchored" data-anchor-id="beyond-the-basics-generalized-linear-models">Beyond The Basics: Generalized Linear Models</h2>
<p>Linear models can be extended to handle other types of outcomes:</p>
<p><span class="math display">g(E[Y]) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ...</span></p>
<p>Where <span class="math inline">g()</span> is a link function:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Model Type</th>
<th>Outcome</th>
<th>Link Function</th>
<th>Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Linear Model</td>
<td>Continuous</td>
<td>Identity</td>
<td>Linear regression</td>
</tr>
<tr class="even">
<td>Logistic Model</td>
<td>Binary</td>
<td>Logit</td>
<td>Binary classification</td>
</tr>
<tr class="odd">
<td>Poisson Model</td>
<td>Count</td>
<td>Log</td>
<td>Event frequency</td>
</tr>
</tbody>
</table>
<p>The general linear model framework extends naturally to handle many different types of outcome variables, not just continuous ones.</p>
<div class="notes">
<p>While we’ve focused on the general linear model (GLM) for continuous outcomes, the framework extends naturally to other types of outcomes through Generalized Linear Models (GLMs).</p>
<p>The key innovation in GLMs is the addition of a link function, which transforms the expected value of the outcome. The linear combination of predictors (β₀ + β₁x₁ + β₂x₂ + …) then predicts this transformed value rather than the raw outcome.</p>
<p>Different types of outcomes call for different link functions:</p>
<ul>
<li>For continuous outcomes, we use the identity link (no transformation), giving us the standard linear model</li>
<li>For binary outcomes (0/1), we use the logit link, giving us logistic regression</li>
<li>For count data, we use the log link, giving us Poisson regression</li>
</ul>
<p>Other common GLMs include:</p>
<ul>
<li>Probit regression (using the probit link for binary outcomes)</li>
<li>Negative binomial regression (an alternative to Poisson for overdispersed count data)</li>
<li>Gamma regression (for positive continuous data with variance proportional to the square of the mean)</li>
</ul>
<p>This extension to GLMs shows how the same core concepts we’ve explored apply across a wide range of statistical models.</p>
</div>
</section><section id="practical-code-cheat-sheet" class="level2"><h2 class="anchored" data-anchor-id="practical-code-cheat-sheet">Practical Code Cheat Sheet</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># CORRELATION</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>                     <span class="co"># Pearson correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>            <span class="co"># Same as Pearson</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method<span class="op">=</span><span class="st">"spearman"</span><span class="op">)</span>  <span class="co"># Spearman correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>              <span class="co"># Approximates Spearman</span></span>
<span></span>
<span><span class="co"># ONE SAMPLE TESTS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">y</span>, mu<span class="op">=</span><span class="fl">0</span><span class="op">)</span>                    <span class="co"># One-sample t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>                          <span class="co"># Same as one-sample t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">y</span>, mu<span class="op">=</span><span class="fl">0</span><span class="op">)</span>               <span class="co"># Wilcoxon signed-rank</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu">signed_rank</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>             <span class="co"># Approximates Wilcoxon</span></span>
<span></span>
<span><span class="co"># TWO SAMPLE TESTS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>                  <span class="co"># Independent t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>                      <span class="co"># Same as independent t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">post</span>, <span class="va">pre</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>     <span class="co"># Paired t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">post</span> <span class="op">-</span> <span class="va">pre</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>                 <span class="co"># Same as paired t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>             <span class="co"># Mann-Whitney U</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>                <span class="co"># Approximates Mann-Whitney</span></span>
<span></span>
<span><span class="co"># ANOVA &amp; REGRESSION</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>                     <span class="co"># One-way ANOVA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>                      <span class="co"># Same as one-way ANOVA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">factorA</span> <span class="op">*</span> <span class="va">factorB</span><span class="op">)</span>         <span class="co"># Two-way ANOVA  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">factorA</span> <span class="op">*</span> <span class="va">factorB</span><span class="op">)</span>          <span class="co"># Same as two-way ANOVA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="va">covariate</span><span class="op">)</span>          <span class="co"># ANCOVA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span><span class="op">)</span>               <span class="co"># Multiple regression</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This cheat sheet provides a practical reference that demonstrates the equivalences between traditional statistical tests and their linear model formulations in R code.</p>
<div class="notes">
<p>This code cheat sheet provides a quick reference for the equivalences we’ve explored between traditional statistical tests and their linear model formulations in R.</p>
<p>The cheat sheet is organized by test type: - Correlation tests (Pearson and Spearman) - One-sample tests (t-test and Wilcoxon signed-rank) - Two-sample tests (independent t-test, paired t-test, Mann-Whitney U) - ANOVA and regression models (one-way ANOVA, two-way ANOVA, ANCOVA, multiple regression)</p>
<p>For each traditional test (e.g., t.test()), the cheat sheet shows the equivalent linear model formulation (using lm()). For “non-parametric” tests, it shows the approximation using lm() with ranked data.</p>
<p>Students can use this as a reference when transitioning from thinking about statistics as a collection of separate tests to understanding them as variations of the unified linear model framework.</p>
</div>
</section><section id="the-power-of-the-unified-approach" class="level2"><h2 class="anchored" data-anchor-id="the-power-of-the-unified-approach">The Power of the Unified Approach</h2>
<p>Benefits of viewing statistical tests as linear models:</p>
<div class="incremental">
<ol class="incremental" type="1">
<li>
<strong>Conceptual simplicity</strong>: Learn one framework instead of many isolated techniques</li>
<li>
<strong>Flexibility</strong>: Easily combine and extend models to suit your research questions</li>
<li>
<strong>Interpretability</strong>: Consistent approach to understanding and communicating results</li>
<li>
<strong>Practicality</strong>: Simplifies implementation in statistical software</li>
<li>
<strong>Extensibility</strong>: Natural pathway to more advanced methods (mixed effects, generalized linear models)</li>
</ol>
</div>
<div class="notes">
<p>The unified linear model approach offers several benefits over the traditional approach of teaching statistical tests as separate, unrelated techniques.</p>
<p>First, it’s conceptually simpler. Instead of learning different formulas and procedures for t-tests, ANOVA, regression, etc., you learn one framework that encompasses all of these.</p>
<p>Second, it’s more flexible. You can easily combine different types of predictors and test complex hypotheses within the same framework.</p>
<p>Third, it provides a consistent approach to interpretation. The coefficients in a linear model always have the same basic interpretation, regardless of whether the model is implementing a t-test, ANOVA, or regression.</p>
<p>Fourth, it’s practical. In R and many other statistical software packages, the linear model (lm() function in R) is the workhorse for a wide range of analyses.</p>
<p>Finally, it provides a natural pathway to more advanced methods like mixed-effects models and generalized linear models, which extend the linear model framework to handle more complex data structures and non-normal distributions.</p>
</div>
</section><section id="practical-implications-of-the-glm-framework" class="level2"><h2 class="anchored" data-anchor-id="practical-implications-of-the-glm-framework">Practical Implications of the GLM Framework</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Now that we’ve explored various extensions of the GLM framework, let’s consider the practical implications:</p>
<ol type="1">
<li>
<strong>Data analysis workflow becomes more coherent</strong>:
<ul>
<li>Start with your research question</li>
<li>Identify outcome and predictor variables</li>
<li>Select appropriate version of the GLM</li>
<li>Interpret coefficients in a consistent way</li>
</ul>
</li>
<li>
<strong>Model extensions become more accessible</strong>:
<ul>
<li>Add interactions to test context-dependent effects</li>
<li>Include covariates to control for confounders</li>
<li>Transform variables to meet assumptions</li>
<li>Move to GLMs for non-normal outcomes</li>
</ul>
</li>
</ol>
</div><div class="column" style="width:40%;">
<p><img src="https://images.unsplash.com/photo-1561557944-6e7860d1a7eb?q=80&amp;w=1887&amp;auto=format&amp;fit=crop.png" class="img-fluid"></p>
</div>
</div>
<div class="notes">
<p>These practical implications highlight how the general linear model framework changes not just how we understand statistics conceptually, but also how we approach data analysis in practice.</p>
<p>When facing a new analytical problem, thinking in terms of the linear model helps clarify the essential components: the outcome variable, the predictor variables, and the relationships we’re interested in testing. This approach guides the entire analysis process.</p>
<p>The unified framework also makes it much easier to extend and adapt models to fit different research scenarios. For instance: - Adding interaction terms allows us to test whether the effect of one variable depends on the level of another - Including covariates helps control for potential confounding variables - Variable transformations (like ranking for non-parametric tests) can help meet model assumptions - Extending to generalized linear models allows us to analyze non-normal outcomes like binary or count data</p>
<p>This flexibility is a major advantage over the traditional “cookbook” approach to statistics, where each test is treated as a separate entity with its own rules and applications.</p>
<p>By focusing on the underlying linear model framework, we’re equipping students with a more powerful and adaptable analytical toolkit.</p>
</div>
</section><section id="concluding-thoughts" class="level2"><h2 class="anchored" data-anchor-id="concluding-thoughts">Concluding Thoughts</h2>
<ul>
<li>Statistical tests are not isolated tools but connected members of the same family</li>
<li>The general linear model provides a unified framework for understanding these connections</li>
<li>This perspective simplifies learning, application, and interpretation of statistics</li>
<li>When facing a new analytical problem, think in terms of the linear model: what is my outcome? What are my predictors? What relationships am I testing?</li>
</ul>
<div class="notes">
<p>In conclusion, the general linear model provides a powerful, unified framework for statistical analysis. By understanding that many common statistical tests are special cases of the linear model, we gain a deeper and more coherent understanding of statistics.</p>
<p>Rather than memorizing different formulas and procedures for different tests, we can focus on understanding the core principles of the linear model and how to apply them to different research questions.</p>
<p>When approaching a new analytical problem, thinking in terms of the linear model helps clarify the essential components: the outcome variable, the predictor variables, and the relationships we’re interested in testing.</p>
<p>This approach not only simplifies learning and application but also enables us to build more sophisticated models that better capture the complexity of real-world phenomena.</p>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/drandrewmitchell\.com\/BSSC0021-Code");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>