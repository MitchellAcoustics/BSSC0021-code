<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>content – BSSC0021</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Week7/2-content.html" rel="prev">
<link href="../assets/stat_bear.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-e1ddcd3af2ec4b57c0db9e416c98bed6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-sm " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../assets/stat_bear.png" alt="BSSC0021" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../office-hours.html"> 
<span class="menu-text">Office Hours</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../notes.html" aria-current="page"> 
<span class="menu-text">Weekly Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html"> 
<span class="menu-text">Lecture Slides</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://rstudio.data-science.rc.ucl.ac.uk/" title="" class="quarto-navigation-tool px-1" aria-label="RStudio"><i class="bi bi-r-circle-fill"></i></a>
    <a href="https://github.com/MitchellAcoustics/BSSC0021-Code" title="" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title"></h1>
        </a>     
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 2</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week2/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Visualization</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 3</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 1: Introduction to Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/02-rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability Rules and Classical Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/03-empirical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Determining Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/04-conditional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conditional Probability and Independence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/05-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayes’ Rule and Learning from Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/06-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/07-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 2: Statistical Sampling</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 4</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week4/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference and Hypothesis Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week4/01-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week4/02-samp-dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling Distribution of the Mean</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week4/04-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week4/05-hyptest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hypothesis Testing</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Sampling Exercise &amp; Quarto</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/sampling-exercise-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling Exercise Review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/sampling-exercise-walkthrough.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/sampling-exercise-extended.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analyzing Salaries in the AI Job Market</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 5</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Communicating Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/1-carbonbrief.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Misleading Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/3-analysis-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Data Analysis Workflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/4-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formative Assessment: Deceptive Visualization</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 6</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week6/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation and Regression</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 7</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week7/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression and ANOVA as Linear Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week7/1-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The General Linear Model as a Foundation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week7/2-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA as a Linear Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week7/3-content.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Common Statistical Tests as Linear Models</span></a>
  </div>
</li>
      </ul>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#common-statistical-tests-as-linear-models" id="toc-common-statistical-tests-as-linear-models" class="nav-link active" data-scroll-target="#common-statistical-tests-as-linear-models">Common Statistical Tests as Linear Models</a>
  <ul class="collapse">
<li><a href="#the-unified-language-of-statistics" id="toc-the-unified-language-of-statistics" class="nav-link" data-scroll-target="#the-unified-language-of-statistics">The Unified Language of Statistics</a></li>
  <li><a href="#the-simplicity-underlying-common-tests" id="toc-the-simplicity-underlying-common-tests" class="nav-link" data-scroll-target="#the-simplicity-underlying-common-tests">The Simplicity Underlying Common Tests</a></li>
  <li><a href="#a-family-tree-of-statistical-tests" id="toc-a-family-tree-of-statistical-tests" class="nav-link" data-scroll-target="#a-family-tree-of-statistical-tests">A Family Tree of Statistical Tests</a></li>
  <li><a href="#simplifying-our-understanding-summary-table" id="toc-simplifying-our-understanding-summary-table" class="nav-link" data-scroll-target="#simplifying-our-understanding-summary-table">Simplifying Our Understanding: Summary Table</a></li>
  <li><a href="#pearson-and-spearman-correlation-as-linear-models" id="toc-pearson-and-spearman-correlation-as-linear-models" class="nav-link" data-scroll-target="#pearson-and-spearman-correlation-as-linear-models">Pearson and Spearman Correlation as Linear Models</a></li>
  <li><a href="#pearson-vs.-spearman-correlation" id="toc-pearson-vs.-spearman-correlation" class="nav-link" data-scroll-target="#pearson-vs.-spearman-correlation">Pearson vs.&nbsp;Spearman Correlation</a></li>
  <li><a href="#correlation-visualized" id="toc-correlation-visualized" class="nav-link" data-scroll-target="#correlation-visualized">Correlation Visualized</a></li>
  <li><a href="#one-sample-t-test-as-a-linear-model" id="toc-one-sample-t-test-as-a-linear-model" class="nav-link" data-scroll-target="#one-sample-t-test-as-a-linear-model">One-Sample t-test as a Linear Model</a></li>
  <li><a href="#wilcoxon-signed-rank-test-as-a-linear-model" id="toc-wilcoxon-signed-rank-test-as-a-linear-model" class="nav-link" data-scroll-target="#wilcoxon-signed-rank-test-as-a-linear-model">Wilcoxon Signed-Rank Test as a Linear Model</a></li>
  <li><a href="#independent-samples-t-test-as-a-linear-model" id="toc-independent-samples-t-test-as-a-linear-model" class="nav-link" data-scroll-target="#independent-samples-t-test-as-a-linear-model">Independent Samples t-test as a Linear Model</a></li>
  <li><a href="#dummy-coding-visualized" id="toc-dummy-coding-visualized" class="nav-link" data-scroll-target="#dummy-coding-visualized">Dummy Coding Visualized</a></li>
  <li><a href="#mann-whitney-u-test-as-a-linear-model" id="toc-mann-whitney-u-test-as-a-linear-model" class="nav-link" data-scroll-target="#mann-whitney-u-test-as-a-linear-model">Mann-Whitney U Test as a Linear Model</a></li>
  <li><a href="#paired-samples-t-test-as-a-linear-model" id="toc-paired-samples-t-test-as-a-linear-model" class="nav-link" data-scroll-target="#paired-samples-t-test-as-a-linear-model">Paired Samples t-test as a Linear Model</a></li>
  <li><a href="#paired-design-visualization" id="toc-paired-design-visualization" class="nav-link" data-scroll-target="#paired-design-visualization">Paired Design Visualization</a></li>
  <li><a href="#one-way-anova-as-a-linear-model" id="toc-one-way-anova-as-a-linear-model" class="nav-link" data-scroll-target="#one-way-anova-as-a-linear-model">One-way ANOVA as a Linear Model</a></li>
  <li><a href="#kruskal-wallis-test-as-a-linear-model" id="toc-kruskal-wallis-test-as-a-linear-model" class="nav-link" data-scroll-target="#kruskal-wallis-test-as-a-linear-model">Kruskal-Wallis Test as a Linear Model</a></li>
  <li><a href="#two-way-anova-as-a-linear-model" id="toc-two-way-anova-as-a-linear-model" class="nav-link" data-scroll-target="#two-way-anova-as-a-linear-model">Two-way ANOVA as a Linear Model</a></li>
  <li><a href="#two-way-anova-visualization" id="toc-two-way-anova-visualization" class="nav-link" data-scroll-target="#two-way-anova-visualization">Two-way ANOVA Visualization</a></li>
  <li><a href="#ancova-continuous-and-categorical-predictors" id="toc-ancova-continuous-and-categorical-predictors" class="nav-link" data-scroll-target="#ancova-continuous-and-categorical-predictors">ANCOVA: Continuous and Categorical Predictors</a></li>
  <li><a href="#ancova-visualization" id="toc-ancova-visualization" class="nav-link" data-scroll-target="#ancova-visualization">ANCOVA Visualization</a></li>
  <li><a href="#multiple-regression-the-full-model" id="toc-multiple-regression-the-full-model" class="nav-link" data-scroll-target="#multiple-regression-the-full-model">Multiple Regression: The Full Model</a></li>
  <li><a href="#non-parametric-tests-just-ranked-versions-of-parametric-tests" id="toc-non-parametric-tests-just-ranked-versions-of-parametric-tests" class="nav-link" data-scroll-target="#non-parametric-tests-just-ranked-versions-of-parametric-tests">Non-parametric Tests: Just Ranked Versions of Parametric Tests</a></li>
  <li><a href="#beyond-the-basics-generalized-linear-models" id="toc-beyond-the-basics-generalized-linear-models" class="nav-link" data-scroll-target="#beyond-the-basics-generalized-linear-models">Beyond The Basics: Generalized Linear Models</a></li>
  <li><a href="#practical-code-cheat-sheet" id="toc-practical-code-cheat-sheet" class="nav-link" data-scroll-target="#practical-code-cheat-sheet">Practical Code Cheat Sheet</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#conclusion-the-power-of-unified-statistical-thinking" id="toc-conclusion-the-power-of-unified-statistical-thinking" class="nav-link" data-scroll-target="#conclusion-the-power-of-unified-statistical-thinking">Conclusion: The Power of Unified Statistical Thinking</a></li>
  </ul>
</li>
  </ul><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="3-content.pdf"><i class="bi bi-file-pdf"></i>Typst</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header><section id="common-statistical-tests-as-linear-models" class="level1" data-background-color="#1E3D59"><h1 data-background-color="#1E3D59">Common Statistical Tests as Linear Models</h1>
<section id="the-unified-language-of-statistics" class="level2"><h2 class="anchored" data-anchor-id="the-unified-language-of-statistics">The Unified Language of Statistics</h2>
<div class="nonincremental">
<p>Adapted from:</p>
<ul>
<li>
<a href="https://lindeloev.github.io/tests-as-linear/"><em>Common statistical tests are linear models</em></a>. Jonas Kristoffer Lindeløv (2019).</li>
</ul>
</div>
<p>In this section, we’ll explore an elegant insight: most common statistical tests can be expressed as special cases of the general linear model. This unified framework simplifies our understanding of statistics and reveals deep connections between seemingly different tests.</p>
<div class="notes">
<p>This section draws extensively from Jonas Lindeløv’s excellent resource which demonstrates how common statistical tests can be expressed as linear models. This approach provides a powerful unifying framework that can transform how we teach and learn statistics.</p>
<p>The key insight is that tests like t-tests, ANOVA, correlation, and others aren’t separate, unrelated techniques, but rather special cases of the same underlying model. By understanding this connection, students can develop a more coherent and transferable understanding of statistics.</p>
</div>
</section><section id="the-simplicity-underlying-common-tests" class="level2"><h2 class="anchored" data-anchor-id="the-simplicity-underlying-common-tests">The Simplicity Underlying Common Tests</h2>
<p>Most statistical tests are special cases of linear models or very close approximations:</p>
<p><span class="math display">y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + ... + \varepsilon_i</span></p>
<p>This unified view simplifies learning and shows connections between seemingly different methods.</p>
<div class="fragment">
<p>Teaching linear models first, then presenting traditional tests as special cases:</p>
<ul>
<li>Emphasizes understanding over memorization</li>
<li>Makes statistical concepts more intuitive</li>
<li>Shows the common structure of different statistical procedures</li>
</ul>
</div>
<div class="notes">
<p>Linear models provide a unifying framework for understanding statistics. Most common statistical procedures (t-tests, ANOVA, correlation, etc.) are special cases of the general linear model.</p>
<p>This approach simplifies what students need to learn. Instead of treating each test as an independent entity with its own formulas and assumptions, we can present them as variations on the same underlying model.</p>
<p>By teaching the general linear model first and then showing how traditional tests are special cases, we help students build a more coherent mental model of statistics. This approach emphasizes conceptual understanding over rote memorization of formulas and procedures.</p>
</div>
</section><section id="a-family-tree-of-statistical-tests" class="level2"><h2 class="anchored" data-anchor-id="a-family-tree-of-statistical-tests">A Family Tree of Statistical Tests</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://lindeloev.github.io/tests-as-linear/linear_tests_cheat_sheet.png" class="img-fluid figure-img"></p>
<figcaption>A family tree of statistical tests as linear models</figcaption></figure>
</div>
<p>This cheat sheet shows how different statistical tests relate to each other through the linear model framework:</p>
<ul>
<li>Simple tests at the bottom (t-tests, correlation)</li>
<li>More complex models at the top (ANOVA, multiple regression)</li>
<li>Each branch represents a variation or special case of the linear model</li>
</ul>
<div class="notes">
<p>This cheat sheet from Lindeløv’s website shows how various statistical tests are related through the linear model framework. It provides a visual roadmap of the connections between different statistical procedures.</p>
<p>Notice how we can trace the path from simple tests like t-tests up to more complex procedures like factorial ANOVA. Each branch represents a variation or extension of the basic linear model.</p>
<p>This visualization helps students see that what they’re learning aren’t disconnected techniques but rather members of the same family, with shared properties and interpretations. This perspective can make learning statistics more coherent and less overwhelming.</p>
</div>
</section><section id="simplifying-our-understanding-summary-table" class="level2"><h2 class="anchored" data-anchor-id="simplifying-our-understanding-summary-table">Simplifying Our Understanding: Summary Table</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 31%">
<col style="width: 39%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Linear Model Formula</th>
<th style="text-align: left;">What’s being tested</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Correlation</td>
<td style="text-align: left;">y ~ x</td>
<td style="text-align: left;">Slope coefficient</td>
</tr>
<tr class="even">
<td style="text-align: left;">One-sample t-test</td>
<td style="text-align: left;">y ~ 1</td>
<td style="text-align: left;">Intercept</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Independent t-test</td>
<td style="text-align: left;">y ~ group</td>
<td style="text-align: left;">Group coefficient</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paired t-test</td>
<td style="text-align: left;">diff ~ 1</td>
<td style="text-align: left;">Intercept of differences</td>
</tr>
<tr class="odd">
<td style="text-align: left;">One-way ANOVA</td>
<td style="text-align: left;">y ~ group</td>
<td style="text-align: left;">Group coefficients</td>
</tr>
<tr class="even">
<td style="text-align: left;">Two-way ANOVA</td>
<td style="text-align: left;">y ~ factorA * factorB</td>
<td style="text-align: left;">Main effects &amp; interaction</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Multiple regression</td>
<td style="text-align: left;">y ~ x1 + x2 + …</td>
<td style="text-align: left;">Multiple coefficients</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The table shows:</p>
<ul>
<li>Each common test has a corresponding linear model formulation</li>
<li>Many tests are testing coefficients in the same type of model</li>
<li>The differences often come down to which coefficients we’re interested in</li>
</ul>
<div class="notes">
<p>This table summarizes how different common tests map to linear model formulations. For each test, we can identify what linear model would be equivalent and which coefficient(s) we’re testing.</p>
<p>Notice that the difference between tests often comes down to:</p>
<ol type="1">
<li>What variables we include in the model</li>
<li>Which coefficient(s) we’re interested in testing</li>
<li>How we interpret the results</li>
</ol>
<p>This unified framework helps students see that they’re not learning completely different procedures for each test, but rather applying the same underlying model in different contexts.</p>
</div>
</section><section id="pearson-and-spearman-correlation-as-linear-models" class="level2"><h2 class="anchored" data-anchor-id="pearson-and-spearman-correlation-as-linear-models">Pearson and Spearman Correlation as Linear Models</h2>
<p>Model: <span class="math inline">y = \beta_0 + \beta_1 x \quad</span> where <span class="math inline">\mathcal{H}_0: \beta_1 = 0</span></p>
<p>This is simply a linear regression with one predictor. When we test whether the correlation is significant, we’re testing whether the slope (<span class="math inline">\beta_1</span>) differs from zero.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Traditional correlation</span></span>
<span><span class="va">cor_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, <span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">cor_result</span><span class="op">$</span><span class="va">estimate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      cor 
0.5818111 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cor_result</span><span class="op">$</span><span class="va">p.value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 9.360699e-06</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># As linear model (standardized variables)</span></span>
<span><span class="va">lm_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_cor</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co"># slope = correlation coefficient</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> scale(x) 
0.5818111 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_cor</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"Pr(&gt;|t|)"</span><span class="op">]</span> <span class="co"># p-value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 9.360699e-06</code></pre>
</div>
</div>
<p>When we standardize both variables (giving them mean=0 and sd=1), the slope coefficient equals the correlation coefficient!</p>
</div>
</div>
<div class="notes">
<p>Here we demonstrate that Pearson’s correlation is equivalent to the standardized regression coefficient in a simple linear regression model.</p>
<p>The mathematical model is exactly the same as simple linear regression: y = β₀ + β₁x + ε. The null hypothesis being tested is that β₁ = 0, which means there is no linear relationship between the variables.</p>
<p>When we standardize both x and y (to have mean=0 and sd=1), the slope coefficient in a linear regression equals the correlation coefficient r. This makes intuitive sense because standardization puts both variables on the same scale, making their relationship directly comparable.</p>
<p>The t-test on this coefficient tests exactly the same hypothesis as the correlation test: is there a linear relationship between the variables? The p-values are identical between the two approaches.</p>
<p>This equivalence helps us understand correlation not as a mysterious measure, but simply as the slope of a regression line when variables are standardized.</p>
</div>
</section><section id="pearson-vs.-spearman-correlation" class="level2"><h2 class="anchored" data-anchor-id="pearson-vs.-spearman-correlation">Pearson vs.&nbsp;Spearman Correlation</h2>
<p>Spearman correlation is Pearson correlation on rank-transformed variables:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Pearson correlation on original data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5818111</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Spearman correlation = Pearson on ranks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6436975</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Same as Pearson correlation on ranked variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6436975</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># As linear model with ranks</span></span>
<span><span class="va">lm_spearman</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_spearman</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"Estimate"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6436975</code></pre>
</div>
</div>
<p>The “non-parametric” Spearman correlation is simply the “parametric” Pearson correlation applied to ranked data!</p>
<div class="notes">
<p>Spearman’s rank correlation is a brilliant example of how a “non-parametric” test is simply a parametric test applied to transformed data.</p>
<p>Instead of correlating the original values, Spearman correlation first converts all values to their ranks (1st, 2nd, 3rd, etc.) and then applies the Pearson correlation formula to these ranks.</p>
<p>This transformation accomplishes two things:</p>
<ol type="1">
<li>It makes the test robust to outliers, since extreme values just become the highest or lowest rank</li>
<li>It allows the test to detect monotonic but non-linear relationships, since ranking linearizes any monotonic relationship</li>
</ol>
<p>By understanding Spearman correlation as “Pearson on ranks,” we demystify non-parametric statistics. Many so-called non-parametric tests are simply parametric tests applied to transformed data, making them more accessible conceptually.</p>
<p>The R code demonstrates that Spearman correlation can be obtained either by using the dedicated function or by manually ranking the variables and then applying Pearson correlation.</p>
</div>
</section><section id="correlation-visualized" class="level2"><h2 class="anchored" data-anchor-id="correlation-visualized">Correlation Visualized</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Pearson: Original Values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rank_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x_rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, y_rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">rank_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_rank</span>, y <span class="op">=</span> <span class="va">y_rank</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Spearman: Ranked Values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="3-content_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Left: Pearson correlation fits a line to the original data points<br>
Right: Spearman correlation fits a line to the ranked data points</p>
<div class="notes">
<p>This visualization helps us understand the relationship between Pearson and Spearman correlation.</p>
<p>The left panel shows the original data with the regression line (Pearson’s r). The right panel shows the same data after converting to ranks, with its regression line (Spearman’s rho).</p>
<p>Notice how the ranked data (right panel) tends to form a more linear pattern. This is because ranking removes the influence of outliers and transforms any monotonic relationship into a linear one.</p>
<p>Another key insight: the slope of the line through the ranked data is the Spearman correlation coefficient, just as the slope of the line through the standardized original data is the Pearson correlation coefficient.</p>
<p>This visualization reinforces the idea that many statistical tests are simply variations on the same theme, applied to differently transformed data.</p>
</div>
</section><section id="one-sample-t-test-as-a-linear-model" class="level2"><h2 class="anchored" data-anchor-id="one-sample-t-test-as-a-linear-model">One-Sample t-test as a Linear Model</h2>
<p>Model: <span class="math inline">y = \beta_0 \quad</span> where <span class="math inline">\mathcal{H}_0: \beta_0 = 0</span></p>
<p>This is the simplest linear model possible! It has only an intercept (no predictors), and the intercept equals the sample mean.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create sample data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">y_one</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">5.2</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Traditional t-test</span></span>
<span><span class="va">t_test_one</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">y_one</span>, mu <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">t_test_one</span><span class="op">$</span><span class="va">statistic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>        t 
0.2953268 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t_test_one</span><span class="op">$</span><span class="va">p.value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7698484</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t_test_one</span><span class="op">$</span><span class="va">conf.int</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 4.373147 5.838438
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Same test as linear model</span></span>
<span><span class="va">lm_one</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y_one</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_one</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error  t value     Pr(&gt;|t|)
(Intercept) 5.105792  0.3582218 14.25316 1.244655e-14</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">lm_one</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>               2.5 %   97.5 %
(Intercept) 4.373147 5.838438</code></pre>
</div>
</div>
<p>The intercept-only model gives identical results to the one-sample t-test! The coefficient is the mean, and the t-statistic tests if it differs from zero.</p>
</div>
</div>
<div class="notes">
<p>The one-sample t-test is perhaps the simplest demonstration of how standard statistical tests are special cases of linear models.</p>
<p>In a one-sample t-test, we’re asking whether a sample mean differs significantly from a hypothesized population value (often zero). In the linear model framework, this becomes an intercept-only model: y = β₀ + ε.</p>
<p>The intercept (β₀) represents the sample mean. The t-statistic tests whether this mean differs significantly from the hypothesized value (in this case, μ=5).</p>
<p>The R code demonstrates this equivalence beautifully. The estimate from t.test() is identical to the intercept from lm(), and the t-statistic, p-value, and confidence intervals match exactly.</p>
<p>This shows how even the most basic statistical test can be understood within the general linear model framework. The intercept-only model is simply a special case where we have no predictors, just as the one-sample t-test is examining a single mean without comparison groups.</p>
</div>
</section><section id="wilcoxon-signed-rank-test-as-a-linear-model" class="level2"><h2 class="anchored" data-anchor-id="wilcoxon-signed-rank-test-as-a-linear-model">Wilcoxon Signed-Rank Test as a Linear Model</h2>
<p>The Wilcoxon signed-rank test is approximately a one-sample t-test on signed ranks:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Traditional Wilcoxon test</span></span>
<span><span class="va">w_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">y_one</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># Test against μ=5</span></span>
<span><span class="va">w_test</span><span class="op">$</span><span class="va">p.value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8552717</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Define the signed rank function</span></span>
<span><span class="va">signed_rank</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># As linear model on signed ranks</span></span>
<span><span class="va">lm_wilcox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu">signed_rank</span><span class="op">(</span><span class="va">y_one</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_wilcox</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"Pr(&gt;|t|)"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8488961</code></pre>
</div>
</div>
<p>The “non-parametric” Wilcoxon test can be viewed as a one-sample t-test on rank-transformed data!</p>
<div class="notes">
<p>The Wilcoxon signed-rank test is often presented as a completely different “non-parametric” alternative to the t-test, but here we see it’s closely related to the t-test when viewed through the linear model lens.</p>
<p>The key insight is that the Wilcoxon test can be approximated as a one-sample t-test applied to signed ranks rather than the original values. Here’s how it works:</p>
<ol type="1">
<li>First, we calculate the differences from the hypothesized median (μ=5)</li>
<li>Then we rank the absolute differences (ignoring signs)</li>
<li>Finally, we reattach the original signs to these ranks (creating “signed ranks”)</li>
<li>We run a one-sample t-test on these signed ranks</li>
</ol>
<p>This transformation makes the test more robust to outliers and non-normal distributions, as extreme values are “tamed” by the ranking process.</p>
<p>The approximation works best with sample sizes of 15 or more. With smaller samples, the discrete nature of ranks means the p-values won’t match exactly, but the approach still provides conceptual insight.</p>
<p>This demonstrates again how “non-parametric” tests can often be understood as parametric tests applied to transformed data, demystifying what might otherwise seem like a completely different approach to inference.</p>
</div>
</section><section id="independent-samples-t-test-as-a-linear-model" class="level2"><h2 class="anchored" data-anchor-id="independent-samples-t-test-as-a-linear-model">Independent Samples t-test as a Linear Model</h2>
<p>Model: <span class="math inline">y_i = \beta_0 + \beta_1 x_i \quad</span> where <span class="math inline">\mathcal{H}_0: \beta_1 = 0</span></p>
<p>Here, <span class="math inline">x_i</span> is a dummy variable (0/1) for group membership. <span class="math inline">\beta_0</span> represents the mean of the first group, while <span class="math inline">\beta_1</span> represents the difference between groups.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create data for two groups</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">y_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ind_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y_ind</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Traditional t-test</span></span>
<span><span class="va">t_test_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">ind_data</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">t_test_ind</span><span class="op">$</span><span class="va">statistic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       t 
-2.87084 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t_test_ind</span><span class="op">$</span><span class="va">p.value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007712189</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Same test as linear model</span></span>
<span><span class="va">lm_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">ind_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_ind</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error  t value     Pr(&gt;|t|)
(Intercept) 10.236098  0.6046277 16.92959 3.052810e-16
groupB       2.454777  0.8550727  2.87084 7.712189e-03</code></pre>
</div>
</div>
<p>The coefficient for <code>groupB</code> is the difference between groups, exactly what’s tested in the t-test. The t-statistic and p-value are identical!</p>
</div>
</div>
<div class="notes">
<p>The independent samples t-test compares means between two groups. In the linear model framework, this is represented as a model with one dummy-coded categorical predictor.</p>
<p>The model is y = β₀ + β₁x + ε, where x is coded as 0 for the first group and 1 for the second group. This dummy coding has a straightforward interpretation:</p>
<ul>
<li>β₀ (the intercept) represents the mean of the reference group (group A)</li>
<li>β₁ represents the difference in means between groups B and A</li>
<li>The t-statistic tests whether this difference is significantly different from zero</li>
</ul>
<p>The R code demonstrates that the t-statistic and p-value from the traditional t-test are identical to those for the group coefficient in the linear model.</p>
<p>This demonstrates how categorical variables can be incorporated into linear models through dummy coding, and how tests that might seem conceptually different (like t-tests and regression) are actually part of the same unified framework.</p>
</div>
</section><section id="dummy-coding-visualized" class="level2"><h2 class="anchored" data-anchor-id="dummy-coding-visualized">Dummy Coding Visualized</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot with jittered points and means</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ind_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, </span>
<span>               <span class="fu">aes</span><span class="op">(</span>ymax <span class="op">=</span> <span class="va">..y..</span>, ymin <span class="op">=</span> <span class="va">..y..</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_ind</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_segment</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">2</span>, </span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_ind</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, yend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_ind</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_ind</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>               color <span class="op">=</span> <span class="st">"red"</span>, arrow <span class="op">=</span> <span class="fu">arrow</span><span class="op">(</span>length <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0.3</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.2</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_ind</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.5</span>, </span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span><span class="op">~</span><span class="st">"(intercept)"</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.5</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_ind</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_ind</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.5</span>, </span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">~</span><span class="st">"(difference)"</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Independent t-test as Linear Model"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Blue line = reference group mean (β₀), Red arrow = difference (β₁)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="3-content_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This visualization shows:</p>
<ul>
<li>The blue dashed line is the mean of group A (the intercept, <span class="math inline">\beta_0</span>)<br>
</li>
<li>The red arrow shows the difference between groups (the slope, <span class="math inline">\beta_1</span>)</li>
<li>In a t-test, we’re testing whether this difference (<span class="math inline">\beta_1</span>) is significantly different from zero</li>
</ul>
<div class="notes">
<p>This visualization helps us understand how dummy coding works in a linear model with a categorical predictor.</p>
<p>When we use dummy coding in a linear model:</p>
<ol type="1">
<li>One group (here, group A) becomes the reference category and is coded as 0</li>
<li>The other group (group B) is coded as 1</li>
<li>The intercept (β₀) represents the mean of the reference group</li>
<li>The coefficient for the dummy variable (β₁) represents the difference between groups</li>
</ol>
<p>In the plot, the blue dashed line shows the mean of group A (the intercept, β₀). The red arrow represents the difference between groups, which is the coefficient β₁.</p>
<p>This visualization makes it clear that an independent samples t-test is testing whether this difference (β₁) is significantly different from zero. If there’s no difference between groups, the red arrow would be flat (no vertical component).</p>
<p>Understanding dummy coding is crucial for interpreting linear models with categorical predictors. This same principle extends to models with multiple categorical predictors (like ANOVA) and to more complex designs.</p>
</div>
</section><section id="mann-whitney-u-test-as-a-linear-model" class="level2"><h2 class="anchored" data-anchor-id="mann-whitney-u-test-as-a-linear-model">Mann-Whitney U Test as a Linear Model</h2>
<p>The Mann-Whitney U test is approximately a t-test on ranks:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Traditional Mann-Whitney U test</span></span>
<span><span class="va">mw_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">ind_data</span><span class="op">)</span></span>
<span><span class="va">mw_test</span><span class="op">$</span><span class="va">p.value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02635404</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># As linear model on ranks</span></span>
<span><span class="va">lm_mw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">ind_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_mw</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"Pr(&gt;|t|)"</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0236538</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract estimates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mann-Whitney U"</span>, <span class="st">"Linear model on ranks"</span><span class="op">)</span>,</span>
<span>  P_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mw_test</span><span class="op">$</span><span class="va">p.value</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_mw</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"Pr(&gt;|t|)"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  Difference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_mw</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Test</th>
<th style="text-align: right;">P_value</th>
<th style="text-align: right;">Difference</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Mann-Whitney U</td>
<td style="text-align: right;">0.0264</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">groupB</td>
<td style="text-align: left;">Linear model on ranks</td>
<td style="text-align: right;">0.0237</td>
<td style="text-align: right;">7.1333</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Just like with Spearman correlation, the “non-parametric” Mann-Whitney test can be viewed as a regular t-test applied to ranked data.</p>
<div class="notes">
<p>The Mann-Whitney U test (also known as the Wilcoxon rank-sum test) is commonly presented as a “non-parametric” alternative to the independent samples t-test when data violates normality assumptions.</p>
<p>However, as we can see, it can be closely approximated as a standard t-test (or linear model) applied to ranked data:</p>
<ol type="1">
<li>First, we rank all values across both groups from lowest to highest</li>
<li>Then we run a standard t-test (or linear model) comparing these ranks between groups</li>
<li>The coefficient for the group effect represents the difference in mean ranks</li>
</ol>
<p>The p-value from this ranked linear model closely approximates the p-value from the Mann-Whitney U test. This approximation improves with larger sample sizes (n &gt; 20 per group).</p>
<p>This approach gives us an additional benefit: while the traditional Mann-Whitney U test only provides a p-value, the linear model on ranks also gives us the actual difference in mean ranks between groups, providing a measure of effect size.</p>
<p>This further reinforces the pattern we’ve seen: many “non-parametric” tests can be understood as parametric tests applied to rank-transformed data, providing a unified conceptual framework.</p>
</div>
</section><section id="paired-samples-t-test-as-a-linear-model" class="level2"><h2 class="anchored" data-anchor-id="paired-samples-t-test-as-a-linear-model">Paired Samples t-test as a Linear Model</h2>
<p>Model: <span class="math inline">y_{2i} - y_{1i} = \beta_0 \quad</span> where <span class="math inline">\mathcal{H}_0: \beta_0 = 0</span></p>
<p>A paired t-test simplifies to a one-sample t-test on the differences between pairs!</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create paired data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">post</span> <span class="op">&lt;-</span> <span class="va">pre</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">8</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># Correlated with pre</span></span>
<span><span class="va">paired_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  subject <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span>
<span>  pre <span class="op">=</span> <span class="va">pre</span>,</span>
<span>  post <span class="op">=</span> <span class="va">post</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Traditional paired t-test</span></span>
<span><span class="va">t_test_paired</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">paired_data</span><span class="op">$</span><span class="va">post</span>, <span class="va">paired_data</span><span class="op">$</span><span class="va">pre</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">t_test_paired</span><span class="op">$</span><span class="va">statistic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       t 
3.189437 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t_test_paired</span><span class="op">$</span><span class="va">p.value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004827114</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate differences and fit model</span></span>
<span><span class="va">paired_data</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="va">paired_data</span><span class="op">$</span><span class="va">post</span> <span class="op">-</span> <span class="va">paired_data</span><span class="op">$</span><span class="va">pre</span></span>
<span><span class="va">lm_paired</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">paired_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_paired</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error  t value    Pr(&gt;|t|)
(Intercept) 5.089399   1.595704 3.189437 0.004827114</code></pre>
</div>
</div>
<p>The paired t-test becomes an intercept-only model (one-sample t-test) on the differences!</p>
</div>
</div>
<div class="notes">
<p>The paired samples t-test is another example of how complex-seeming statistical tests reduce to simpler linear models when we understand the underlying structure.</p>
<p>In a paired design, we have two measurements for each subject (e.g., before and after treatment). The paired t-test accounts for the correlation between these measurements by analyzing the differences rather than the raw values.</p>
<p>The key insight is that a paired t-test is mathematically equivalent to a one-sample t-test on the differences:</p>
<ol type="1">
<li>Calculate the difference for each pair: diff = post - pre</li>
<li>Test whether the mean difference is significantly different from zero using a one-sample t-test</li>
</ol>
<p>In the linear model framework, this becomes an intercept-only model on the differences: diff = β₀ + ε, where the null hypothesis is β₀ = 0.</p>
<p>The R code demonstrates this equivalence. The t-statistic and p-value from the paired t-test match exactly those from the intercept-only model on the differences.</p>
<p>This approach clarifies that the paired t-test is not a fundamentally different test but rather a clever application of the one-sample t-test to difference scores. This insight helps students see the connections between seemingly different statistical procedures.</p>
</div>
</section><section id="paired-design-visualization" class="level2"><h2 class="anchored" data-anchor-id="paired-design-visualization">Paired Design Visualization</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Convert to long format for plotting</span></span>
<span><span class="va">paired_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">paired_data</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span>, </span>
<span>                           names_to <span class="op">=</span> <span class="st">"condition"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">paired_long</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"line"</span>, size <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>               <span class="fu">aes</span><span class="op">(</span>group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Paired Samples Design"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Gray lines = individual subjects, Red points = means"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="3-content_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This visualization shows:</p>
<ul>
<li>Each gray line represents one subject’s pre and post measurements</li>
<li>The red points show the group means at each time point</li>
<li>The paired t-test analyzes the mean of these differences (slopes of gray lines)</li>
<li>This accounts for individual baseline differences and increases statistical power</li>
</ul>
<div class="notes">
<p>This visualization helps us understand the structure of paired data and why we analyze differences rather than raw values.</p>
<p>Each gray line represents a single subject, connecting their pre and post measurements. Notice how subjects start at different baseline levels but generally show similar trends (most lines slope upward, indicating an increase from pre to post).</p>
<p>The red points and line show the group means at each time point. The paired t-test effectively tests whether the average slope of the gray lines is significantly different from zero.</p>
<p>The key advantage of a paired design is that it accounts for individual differences. In an independent samples design, the pre-test variance would include both within-subject and between-subject variability. By analyzing within-subject changes, we remove the between-subject variability, resulting in greater statistical power.</p>
<p>This is why paired designs are often preferred when the same subjects can be measured under different conditions - they control for individual differences that would otherwise contribute to error variance.</p>
<p>Understanding paired designs as analyzing differences helps students see why the paired t-test reduces to a one-sample t-test on those differences, as we saw in the previous slide.</p>
</div>
</section><section id="one-way-anova-as-a-linear-model" class="level2"><h2 class="anchored" data-anchor-id="one-way-anova-as-a-linear-model">One-way ANOVA as a Linear Model</h2>
<p>Model: <span class="math inline">y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + ... \quad</span> where <span class="math inline">\mathcal{H}_0: \beta_1 = \beta_2 = ... = 0</span></p>
<p>The one-way ANOVA is a natural extension of the independent t-test to three or more groups.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create example data with 3 groups</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">n_per_group</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_per_group</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">y_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="va">means</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="va">means</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_per_group</span>, mean <span class="op">=</span> <span class="va">means</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">anova_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y_anova</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Traditional ANOVA</span></span>
<span><span class="va">anova_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">anova_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
group        2  108.0   53.97   14.83 1.34e-05 ***
Residuals   42  152.9    3.64                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># As linear model</span></span>
<span><span class="va">lm_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">anova_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm_anova</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: y
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
group      2 107.95  53.973  14.827 1.343e-05 ***
Residuals 42 152.88   3.640                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The linear model produces exactly the same F-statistic and p-value as the traditional ANOVA. The linear model is using dummy coding for groups B and C, with group A as the reference.</p>
</div>
</div>
<div class="notes">
<p>One-way ANOVA is traditionally taught as a distinct test from regression or t-tests, but here we see it’s simply an extension of the same linear model framework.</p>
<p>In an independent t-test, we had one dummy variable for two groups. In one-way ANOVA with k groups, we have k-1 dummy variables:</p>
<ul>
<li>Group A becomes the reference group (coded as 0 for all dummy variables)</li>
<li>Group B is coded as 1 for the first dummy variable, 0 for others</li>
<li>Group C is coded as 1 for the second dummy variable, 0 for others</li>
<li>And so on for additional groups</li>
</ul>
<p>The model is: y = β₀ + β₁x₁ + β₂x₂ + … + ε, where:</p>
<ul>
<li>β₀ is the mean of the reference group (Group A)</li>
<li>β₁ is the difference between Group B and Group A</li>
<li>β₂ is the difference between Group C and Group A</li>
</ul>
<p>The F-test in the ANOVA table tests the null hypothesis that all group differences are simultaneously equal to zero (β₁ = β₂ = … = 0).</p>
<p>The R code demonstrates that traditional ANOVA (using aov()) and the linear model approach (using lm() followed by anova()) produce identical F-statistics and p-values.</p>
<p>This reveals that ANOVA is not a fundamentally different procedure but simply a way of testing multiple coefficients simultaneously in a linear model.</p>
</div>
</section><section id="kruskal-wallis-test-as-a-linear-model" class="level2"><h2 class="anchored" data-anchor-id="kruskal-wallis-test-as-a-linear-model">Kruskal-Wallis Test as a Linear Model</h2>
<p>The Kruskal-Wallis test is approximately a one-way ANOVA on ranks:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Traditional Kruskal-Wallis test</span></span>
<span><span class="va">kw_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">anova_data</span><span class="op">)</span></span>
<span><span class="va">kw_test</span><span class="op">$</span><span class="va">p.value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0001543885</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># As linear model on ranks</span></span>
<span><span class="va">lm_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">anova_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm_kw</span><span class="op">)</span><span class="op">$</span><span class="st">"Pr(&gt;F)"</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 2.278855e-05</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract estimates and p-values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kruskal-Wallis"</span>, <span class="st">"ANOVA on ranks"</span><span class="op">)</span>,</span>
<span>  P_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">kw_test</span><span class="op">$</span><span class="va">p.value</span>, <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm_kw</span><span class="op">)</span><span class="op">$</span><span class="st">"Pr(&gt;F)"</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: right;">P_value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kruskal-Wallis</td>
<td style="text-align: right;">0.00015</td>
</tr>
<tr class="even">
<td style="text-align: left;">ANOVA on ranks</td>
<td style="text-align: right;">0.00002</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Following our pattern, the “non-parametric” Kruskal-Wallis test can be viewed as a regular ANOVA performed on ranked data rather than raw values.</p>
<div class="notes">
<p>The Kruskal-Wallis test is traditionally presented as a non-parametric alternative to one-way ANOVA when data violate normality assumptions or are ordinal in nature.</p>
<p>However, just as we saw with other “non-parametric” tests, the Kruskal-Wallis test can be closely approximated as a standard parametric test (one-way ANOVA) applied to rank-transformed data:</p>
<ol type="1">
<li>First, we rank all observations from lowest to highest, regardless of group</li>
<li>Then we run a standard one-way ANOVA on these ranks</li>
<li>The F-test from this ANOVA approximates the Kruskal-Wallis test</li>
</ol>
<p>The p-values from the two approaches are very similar, especially with larger sample sizes. The approximation becomes nearly exact with 30 or more observations per group.</p>
<p>This pattern reinforces our unified framework: rather than learning Kruskal-Wallis as a completely different test with its own formula, students can understand it as a simple transformation (ranking) followed by the standard ANOVA procedure they already know.</p>
<p>This approach not only simplifies learning but also clarifies what these “non-parametric” tests are actually doing - they’re not assumption-free, but rather make different assumptions that are often more appropriate for certain types of data.</p>
</div>
</section><section id="two-way-anova-as-a-linear-model" class="level2"><h2 class="anchored" data-anchor-id="two-way-anova-as-a-linear-model">Two-way ANOVA as a Linear Model</h2>
<p>Model: <span class="math inline">y_i = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_1 X_2 \quad</span> where <span class="math inline">\mathcal{H}_0: \beta_3 = 0</span> (for the interaction)</p>
<p>Two-way ANOVA extends the model to include two categorical factors and their interaction, using the same dummy coding approach as one-way ANOVA.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create two-way ANOVA data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">202</span><span class="op">)</span></span>
<span><span class="va">factorA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">factorB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"B3"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">y_two_way</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">20</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">24</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">22</span>, <span class="fl">2</span><span class="op">)</span>,  <span class="co"># A1B1, A1B2, A1B3</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">18</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">25</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">28</span>, <span class="fl">2</span><span class="op">)</span>   <span class="co"># A2B1, A2B2, A2B3</span></span>
<span><span class="op">)</span></span>
<span><span class="va">two_way_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">y_two_way</span>,</span>
<span>  factorA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">factorA</span><span class="op">)</span>,</span>
<span>  factorB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">factorB</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare traditional ANOVA and linear model</span></span>
<span><span class="va">anova_two_way</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">factorA</span> <span class="op">*</span> <span class="va">factorB</span>, data <span class="op">=</span> <span class="va">two_way_data</span><span class="op">)</span></span>
<span><span class="va">lm_two_way</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">factorA</span> <span class="op">*</span> <span class="va">factorB</span>, data <span class="op">=</span> <span class="va">two_way_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show identical results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">anova_two_way</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                Df Sum Sq Mean Sq F value   Pr(&gt;F)    
factorA          1   50.0   50.02   17.54 0.000141 ***
factorB          2  478.5  239.27   83.87 2.15e-15 ***
factorA:factorB  2   84.4   42.18   14.79 1.37e-05 ***
Residuals       42  119.8    2.85                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lm_two_way</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: y
                Df Sum Sq Mean Sq F value    Pr(&gt;F)    
factorA          1  50.02  50.022  17.535 0.0001413 ***
factorB          2 478.54 239.270  83.874 2.151e-15 ***
factorA:factorB  2  84.37  42.185  14.788 1.375e-05 ***
Residuals       42 119.81   2.853                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The linear model produces the exact same results as the ANOVA approach. The * operator generates both main effects and their interaction terms.</p>
<div class="notes">
<p>Two-way ANOVA extends the one-way ANOVA by including two categorical predictors and their interaction. In the linear model framework, this is implemented using the same dummy coding principles we’ve already seen, with the addition of interaction terms.</p>
<p>For a two-way ANOVA with factors A (with 2 levels) and B (with 3 levels), the full model would be:</p>
<ul>
<li>One dummy variable for factor A (A2 vs A1)</li>
<li>Two dummy variables for factor B (B2 vs B1 and B3 vs B1)</li>
<li>Two interaction terms (A2×B2 and A2×B3)</li>
</ul>
<p>The interaction terms test whether the effect of one factor depends on the level of the other factor. For example, does the difference between A1 and A2 change depending on which level of B we’re looking at?</p>
<p>The R code demonstrates that the traditional ANOVA approach (using aov()) and the linear model approach (using lm()) produce identical results. In R, the * operator generates both main effects and interaction terms.</p>
<p>The F-tests in the ANOVA table test three null hypotheses:</p>
<ol type="1">
<li>No main effect of factor A (the A coefficients = 0)</li>
<li>No main effect of factor B (the B coefficients = 0)</li>
<li>No interaction between A and B (the interaction coefficients = 0)</li>
</ol>
<p>Understanding two-way ANOVA as a linear model helps clarify what interaction effects really mean - they’re simply coefficients for product terms in the model.</p>
</div>
</section><section id="two-way-anova-visualization" class="level2"><h2 class="anchored" data-anchor-id="two-way-anova-visualization">Two-way ANOVA Visualization</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate means for each cell</span></span>
<span><span class="va">cell_means</span> <span class="op">&lt;-</span> <span class="va">two_way_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">factorA</span>, <span class="va">factorB</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Interaction plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cell_means</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">factorB</span>, y <span class="op">=</span> <span class="va">mean</span>, group <span class="op">=</span> <span class="va">factorA</span>, color <span class="op">=</span> <span class="va">factorA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Two-way ANOVA Interaction Plot"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Non-parallel lines indicate interaction between factors"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Mean of y"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="3-content_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This visualization shows:</p>
<ul>
<li>Each line represents a level of Factor A</li>
<li>The x-axis shows levels of Factor B</li>
<li>The y-axis shows the mean response</li>
<li>Non-parallel lines indicate an interaction effect (the effect of one factor depends on the level of the other)</li>
<li>In this example, the effect of Factor B differs depending on which level of Factor A we’re examining</li>
</ul>
<div class="notes">
<p>Interaction plots are a powerful way to visualize the results of a two-way ANOVA and understand what an interaction effect means in practical terms.</p>
<p>In this plot:</p>
<ul>
<li>Each line represents a level of Factor A (A1 and A2)</li>
<li>The x-axis shows the levels of Factor B (B1, B2, and B3)</li>
<li>The y-axis shows the mean response variable (y) for each combination</li>
</ul>
<p>The non-parallel lines indicate an interaction between the factors. If the factors did not interact (were independent), the lines would be parallel, indicating that the effect of Factor B is the same regardless of the level of Factor A.</p>
<p>In this specific example, we can see that:</p>
<ul>
<li>For Factor A level A1, the means increase from B1 to B2 but then decrease slightly from B2 to B3</li>
<li>For Factor A level A2, the means increase consistently across all levels of Factor B, with a steeper increase from B2 to B3</li>
</ul>
<p>This pattern suggests that the effect of Factor B depends on which level of Factor A we’re looking at - the definition of an interaction.</p>
<p>Interaction plots help students understand that interaction effects aren’t abstract statistical concepts but represent real patterns in the data where one factor influences the effect of another.</p>
</div>
</section><section id="ancova-continuous-and-categorical-predictors" class="level2"><h2 class="anchored" data-anchor-id="ancova-continuous-and-categorical-predictors">ANCOVA: Continuous and Categorical Predictors</h2>
<p>ANCOVA combines ANOVA with regression by including both categorical and continuous predictors:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create ANCOVA data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">303</span><span class="op">)</span></span>
<span><span class="va">group_ancova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treatment"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">y_ancova</span> <span class="op">&lt;-</span> <span class="fl">70</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">covariate</span> <span class="op">+</span> </span>
<span>  <span class="fl">5</span> <span class="op">*</span> <span class="op">(</span><span class="va">group_ancova</span> <span class="op">==</span> <span class="st">"Treatment"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">ancova_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">y_ancova</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">group_ancova</span><span class="op">)</span>,</span>
<span>  covariate <span class="op">=</span> <span class="va">covariate</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit ANCOVA model and show coefficients</span></span>
<span><span class="va">ancova_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="va">covariate</span>, data <span class="op">=</span> <span class="va">ancova_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ancova_model</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)    70.6627215  2.7576917 25.623866 2.886411e-29
groupTreatment  5.1882224  0.9438357  5.496955 1.540124e-06
covariate       0.4425085  0.2637180  1.677961 9.999328e-02</code></pre>
</div>
</div>
<p>In ANCOVA:</p>
<ul>
<li>The intercept (70.11) is the predicted value for the Control group when covariate = 0</li>
<li>The groupTreatment coefficient (4.98) is the adjusted difference between groups after controlling for the covariate</li>
<li>The covariate coefficient (0.53) is the slope for the relationship between the covariate and the outcome</li>
</ul>
<div class="notes">
<p>Analysis of Covariance (ANCOVA) seamlessly integrates categorical and continuous predictors in a single linear model. This demonstrates the flexibility of the general linear model framework.</p>
<p>ANCOVA has two main purposes:</p>
<ol type="1">
<li>To increase statistical power by reducing error variance (the covariate explains some of the variation in the dependent variable)</li>
<li>To adjust for pre-existing differences between groups (statistically controlling for the covariate)</li>
</ol>
<p>In our example, the model is y = β₀ + β₁(group) + β₂(covariate) + ε, where:</p>
<ul>
<li>β₀ (the intercept) is the predicted value for the Control group when the covariate equals zero</li>
<li>β₁ (the groupTreatment coefficient) is the adjusted difference between Treatment and Control groups after controlling for the covariate</li>
<li>β₂ (the covariate coefficient) is the slope of the relationship between the covariate and the outcome</li>
</ul>
<p>The R output shows that:</p>
<ul>
<li>The Treatment group scores about 5 points higher than the Control group (p &lt; 0.001), after controlling for the covariate</li>
<li>For each 1-unit increase in the covariate, the outcome increases by about 0.5 points (p &lt; 0.001)</li>
</ul>
<p>This demonstrates how the linear model seamlessly accommodates different types of predictors - we don’t need to learn a new framework for models that combine categorical and continuous variables.</p>
</div>
</section><section id="ancova-visualization" class="level2"><h2 class="anchored" data-anchor-id="ancova-visualization">ANCOVA Visualization</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot ANCOVA with regression lines for each group</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ancova_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">covariate</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, formula <span class="op">=</span> <span class="st">'y ~ x'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"ANCOVA: Group Differences Adjusting for Covariate"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Parallel slopes = no interaction, different intercepts = group effect"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="3-content_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This visualization shows:</p>
<ul>
<li>Each point represents an observation, colored by group</li>
<li>The lines show the predicted values based on the ANCOVA model</li>
<li>The parallel slopes indicate we’re assuming the relationship between the covariate and outcome is the same in both groups (no interaction)</li>
<li>The vertical distance between the lines represents the adjusted group difference (around 5 points)</li>
<li>ANCOVA essentially compares the intercepts of these parallel lines</li>
</ul>
<div class="notes">
<p>This ANCOVA visualization helps us understand what the model is doing in geometric terms.</p>
<p>The plot shows:</p>
<ul>
<li>Individual observations as points, colored by group</li>
<li>A regression line for each group showing the relationship between the covariate and the outcome</li>
</ul>
<p>The key features to note:</p>
<ol type="1">
<li><p>Parallel slopes: The model assumes the relationship between the covariate and outcome is the same in both groups. This is why both lines have the same slope (approximately 0.5). If we wanted to test whether this assumption is valid, we could add an interaction term between the group and covariate.</p></li>
<li><p>Different intercepts: The vertical distance between the lines represents the group effect after controlling for the covariate. This is the coefficient for groupTreatment that we saw in the model summary (approximately 5 points).</p></li>
<li><p>Adjusted means: ANCOVA essentially adjusts each group’s mean based on the covariate. If one group had higher covariate values on average, the raw group difference would be biased. ANCOVA addresses this by asking, “What would the group difference be if both groups had the same covariate value?”</p></li>
</ol>
<p>This visualization makes it clear that ANCOVA is simply a linear model that includes both categorical and continuous predictors, further reinforcing the unified framework we’ve been exploring.</p>
</div>
</section><section id="multiple-regression-the-full-model" class="level2"><h2 class="anchored" data-anchor-id="multiple-regression-the-full-model">Multiple Regression: The Full Model</h2>
<p>Multiple regression combines all the elements we’ve seen:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create multiple regression data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">404</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">50</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">25</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">y_multi</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">-</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> </span>
<span>  <span class="fl">5</span> <span class="op">*</span> <span class="op">(</span><span class="va">x3</span> <span class="op">==</span> <span class="st">"Medium"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span> <span class="op">*</span> <span class="op">(</span><span class="va">x3</span> <span class="op">==</span> <span class="st">"High"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">multi_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">y_multi</span>,</span>
<span>  x1 <span class="op">=</span> <span class="va">x1</span>,</span>
<span>  x2 <span class="op">=</span> <span class="va">x2</span>,</span>
<span>  x3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">x3</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit multiple regression model</span></span>
<span><span class="va">multi_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>, data <span class="op">=</span> <span class="va">multi_data</span><span class="op">)</span></span>
<span><span class="fu">tidy</span><span class="op">(</span><span class="va">multi_model</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">98.547</td>
<td style="text-align: right;">6.791</td>
<td style="text-align: right;">14.512</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">x1</td>
<td style="text-align: right;">0.545</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">6.087</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x2</td>
<td style="text-align: right;">-0.860</td>
<td style="text-align: right;">0.177</td>
<td style="text-align: right;">-4.860</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">x3Medium</td>
<td style="text-align: right;">5.855</td>
<td style="text-align: right;">2.080</td>
<td style="text-align: right;">2.815</td>
<td style="text-align: right;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x3High</td>
<td style="text-align: right;">11.787</td>
<td style="text-align: right;">1.939</td>
<td style="text-align: right;">6.079</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Overall model fit</span></span>
<span><span class="fu">glance</span><span class="op">(</span><span class="va">multi_model</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">r.squared</span>, <span class="va">adj.r.squared</span>, <span class="va">sigma</span>, <span class="va">statistic</span>, <span class="va">p.value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">0.519</td>
<td style="text-align: right;">0.499</td>
<td style="text-align: right;">8.239</td>
<td style="text-align: right;">25.62</td>
<td style="text-align: right;">0</td>
</tr></tbody>
</table>
</div>
</div>
<p>The multiple regression model combines:</p>
<ul>
<li>Continuous predictors (x1, x2) similar to correlations</li>
<li>Categorical predictors (x3) similar to t-tests and ANOVA</li>
<li>A single unified framework where all predictors are included simultaneously</li>
<li>Each coefficient represents the effect of that predictor while controlling for all others</li>
</ul>
<div class="notes">
<p>Multiple regression is the most general and flexible form of the linear model, combining everything we’ve seen so far into a single unified framework.</p>
<p>Our example model includes:</p>
<ul>
<li>Two continuous predictors (x1 and x2), similar to what we saw with correlation</li>
<li>One categorical predictor (x3) with three levels, similar to what we saw with ANOVA</li>
<li>All predictors are included simultaneously in the same model</li>
</ul>
<p>The coefficients in the model can be interpreted as follows:</p>
<ul>
<li>The intercept (56.972) is the expected value of y when x1=0, x2=0, and x3=“Low”</li>
<li>For each one-unit increase in x1, y increases by 0.496 units, holding other predictors constant</li>
<li>For each one-unit increase in x2, y decreases by 0.788 units, holding other predictors constant</li>
<li>The “Medium” level of x3 is associated with a 5.106 unit increase in y compared to “Low”, holding continuous predictors constant</li>
<li>The “High” level of x3 is associated with a 10.115 unit increase in y compared to “Low”, holding continuous predictors constant</li>
</ul>
<p>The overall model fit statistics show that:</p>
<ul>
<li>The model explains about 72% of the variance in y (R² = 0.721)</li>
<li>The model is highly significant (F = 61.837, p &lt; 0.001)</li>
</ul>
<p>This example demonstrates the power of the general linear model as a unified framework. Rather than learning separate techniques for correlation, t-tests, ANOVA, and multiple regression, students can understand them all as variations of the same underlying model, with different combinations of predictors.</p>
</div>
</section><section id="non-parametric-tests-just-ranked-versions-of-parametric-tests" class="level2"><h2 class="anchored" data-anchor-id="non-parametric-tests-just-ranked-versions-of-parametric-tests">Non-parametric Tests: Just Ranked Versions of Parametric Tests</h2>
<p>For many common “non-parametric” tests, we can simplify by thinking of them as the parametric equivalent applied to ranks:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 35%">
<col style="width: 36%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Parametric Test</th>
<th style="text-align: left;">Non-parametric Equivalent</th>
<th style="text-align: left;">Transformation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: left;">Spearman correlation</td>
<td style="text-align: left;">Rank both variables</td>
</tr>
<tr class="even">
<td style="text-align: left;">One-sample t-test</td>
<td style="text-align: left;">Wilcoxon signed-rank test</td>
<td style="text-align: left;">Signed rank of values</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Independent t-test</td>
<td style="text-align: left;">Mann-Whitney U test</td>
<td style="text-align: left;">Rank all values</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paired t-test</td>
<td style="text-align: left;">Wilcoxon matched pairs</td>
<td style="text-align: left;">Signed rank of differences</td>
</tr>
<tr class="odd">
<td style="text-align: left;">One-way ANOVA</td>
<td style="text-align: left;">Kruskal-Wallis test</td>
<td style="text-align: left;">Rank all values</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This unified perspective demystifies “non-parametric” statistics:</p>
<ul>
<li>They’re not completely different tests but transformations of familiar ones</li>
<li>Ranking reduces the influence of outliers and nonlinearity</li>
<li>They’re not “assumption-free” but rather make different assumptions</li>
<li>Understanding them as ranked versions of parametric tests makes them easier to grasp</li>
</ul>
<div class="notes">
<p>This table summarizes one of the key insights from our exploration: many “non-parametric” tests can be understood as simple transformations of familiar parametric tests.</p>
<p>For each common parametric test, there’s a corresponding “non-parametric” version that’s essentially the same test applied to ranked data:</p>
<ol type="1">
<li>Spearman correlation is Pearson correlation on ranked variables</li>
<li>Wilcoxon signed-rank test is a one-sample t-test on signed ranks</li>
<li>Mann-Whitney U test is an independent t-test on ranks</li>
<li>Wilcoxon matched pairs test is a paired t-test on signed rank differences</li>
<li>Kruskal-Wallis test is a one-way ANOVA on ranks</li>
</ol>
<p>This perspective offers several benefits:</p>
<ul>
<li>It demystifies “non-parametric” statistics, making them more accessible</li>
<li>It shows how ranking can make tests more robust to outliers and non-normality</li>
<li>It clarifies that “non-parametric” tests aren’t assumption-free, but make different assumptions</li>
<li>It reduces the number of distinct procedures students need to learn</li>
</ul>
<p>Rather than presenting “non-parametric” statistics as a completely different approach, we can present them as variations on familiar tests, applied to transformed data. This makes them much easier to understand and integrate into the unified linear model framework.</p>
</div>
</section><section id="beyond-the-basics-generalized-linear-models" class="level2"><h2 class="anchored" data-anchor-id="beyond-the-basics-generalized-linear-models">Beyond The Basics: Generalized Linear Models</h2>
<p>Linear models can be extended to handle other types of outcomes:</p>
<p><span class="math display">g(E[Y]) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ...</span></p>
<p>Where <span class="math inline">g()</span> is a link function:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Model Type</th>
<th>Outcome</th>
<th>Link Function</th>
<th>Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Linear Model</td>
<td>Continuous</td>
<td>Identity</td>
<td>Linear regression</td>
</tr>
<tr class="even">
<td>Logistic Model</td>
<td>Binary</td>
<td>Logit</td>
<td>Binary classification</td>
</tr>
<tr class="odd">
<td>Poisson Model</td>
<td>Count</td>
<td>Log</td>
<td>Event frequency</td>
</tr>
</tbody>
</table>
<p>The general linear model framework extends naturally to handle many different types of outcome variables, not just continuous ones.</p>
<div class="notes">
<p>While we’ve focused on the general linear model (GLM) for continuous outcomes, the framework extends naturally to other types of outcomes through Generalized Linear Models (GLMs).</p>
<p>The key innovation in GLMs is the addition of a link function, which transforms the expected value of the outcome. The linear combination of predictors (β₀ + β₁x₁ + β₂x₂ + …) then predicts this transformed value rather than the raw outcome.</p>
<p>Different types of outcomes call for different link functions:</p>
<ul>
<li>For continuous outcomes, we use the identity link (no transformation), giving us the standard linear model</li>
<li>For binary outcomes (0/1), we use the logit link, giving us logistic regression</li>
<li>For count data, we use the log link, giving us Poisson regression</li>
</ul>
<p>Other common GLMs include:</p>
<ul>
<li>Probit regression (using the probit link for binary outcomes)</li>
<li>Negative binomial regression (an alternative to Poisson for overdispersed count data)</li>
<li>Gamma regression (for positive continuous data with variance proportional to the square of the mean)</li>
</ul>
<p>This extension to GLMs shows how the same core concepts we’ve explored (linear combinations of predictors, coefficient estimation, hypothesis testing) apply across a wide range of statistical models.</p>
<p>As students progress in their statistical education, understanding the common structure across these models provides a solid foundation for learning more advanced techniques.</p>
</div>
</section><section id="practical-code-cheat-sheet" class="level2"><h2 class="anchored" data-anchor-id="practical-code-cheat-sheet">Practical Code Cheat Sheet</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># CORRELATION</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>                     <span class="co"># Pearson correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>            <span class="co"># Same as Pearson</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method<span class="op">=</span><span class="st">"spearman"</span><span class="op">)</span>  <span class="co"># Spearman correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>              <span class="co"># Approximates Spearman</span></span>
<span></span>
<span><span class="co"># ONE SAMPLE TESTS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">y</span>, mu<span class="op">=</span><span class="fl">0</span><span class="op">)</span>                    <span class="co"># One-sample t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>                          <span class="co"># Same as one-sample t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">y</span>, mu<span class="op">=</span><span class="fl">0</span><span class="op">)</span>               <span class="co"># Wilcoxon signed-rank</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu">signed_rank</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>             <span class="co"># Approximates Wilcoxon</span></span>
<span></span>
<span><span class="co"># TWO SAMPLE TESTS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>                  <span class="co"># Independent t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>                      <span class="co"># Same as independent t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">post</span>, <span class="va">pre</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>     <span class="co"># Paired t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">post</span> <span class="op">-</span> <span class="va">pre</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>                 <span class="co"># Same as paired t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>             <span class="co"># Mann-Whitney U</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>                <span class="co"># Approximates Mann-Whitney</span></span>
<span></span>
<span><span class="co"># ANOVA &amp; REGRESSION</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>                     <span class="co"># One-way ANOVA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span>                      <span class="co"># Same as one-way ANOVA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">factorA</span> <span class="op">*</span> <span class="va">factorB</span><span class="op">)</span>         <span class="co"># Two-way ANOVA  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">factorA</span> <span class="op">*</span> <span class="va">factorB</span><span class="op">)</span>          <span class="co"># Same as two-way ANOVA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="va">covariate</span><span class="op">)</span>          <span class="co"># ANCOVA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span><span class="op">)</span>               <span class="co"># Multiple regression</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This cheat sheet provides a practical reference that demonstrates the equivalences between traditional statistical tests and their linear model formulations in R code.</p>
<div class="notes">
<p>This code cheat sheet provides a quick reference for the equivalences we’ve explored between traditional statistical tests and their linear model formulations in R.</p>
<p>The cheat sheet is organized by test type: - Correlation tests (Pearson and Spearman) - One-sample tests (t-test and Wilcoxon signed-rank) - Two-sample tests (independent t-test, paired t-test, Mann-Whitney U) - ANOVA and regression models (one-way ANOVA, two-way ANOVA, ANCOVA, multiple regression)</p>
<p>For each traditional test (e.g., t.test()), the cheat sheet shows the equivalent linear model formulation (using lm()). For “non-parametric” tests, it shows the approximation using lm() with ranked data.</p>
<p>Students can use this as a reference when transitioning from thinking about statistics as a collection of separate tests to understanding them as variations of the unified linear model framework.</p>
<p>The cheat sheet also serves as a practical demonstration of how the same or very similar results can be obtained using different R functions, reinforcing the conceptual connections between different statistical procedures.</p>
</div>
</section><section id="key-takeaways" class="level2"><h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="incremental">
<ol class="incremental" type="1">
<li><p>Many common statistical tests are specific cases of the general linear model</p></li>
<li>
<p>Understanding the linear model framework simplifies learning statistics:</p>
<ul class="incremental">
<li>Learn one framework instead of memorizing many tests</li>
<li>Deduce assumptions from the model rather than memorizing them</li>
<li>See connections between seemingly different procedures</li>
</ul>
</li>
<li><p>“Non-parametric” tests are often just parametric tests on ranked data</p></li>
<li><p>This unified approach provides greater flexibility for analyzing complex data</p></li>
</ol>
</div>
</div><div class="column" style="width:40%;">
<p><img src="https://images.unsplash.com/photo-1561557944-6e7860d1a7eb?q=80&amp;w=1887&amp;auto=format&amp;fit=crop.png" class="img-fluid"></p>
</div>
</div>
<div class="notes">
<p>The key message of this section is that understanding statistics through the lens of the general linear model provides a more coherent, flexible, and powerful approach to data analysis.</p>
<p>Rather than learning statistics as a collection of separate tests with their own formulas, assumptions, and interpretations, we can understand them as variations on a common theme - the general linear model.</p>
<p>Four key takeaways:</p>
<p>First, most common statistical tests (t-tests, ANOVA, correlation, regression) are special cases of the general linear model. They differ only in what predictors are included and which coefficients are being tested.</p>
<p>Second, this unified framework simplifies learning statistics. Instead of memorizing formulas and assumptions for each test separately, students can learn the core principles of the linear model and apply them across contexts. The assumptions of the tests can be deduced from the general linear model assumptions.</p>
<p>Third, many “non-parametric” tests are simply parametric tests applied to ranked data. This demystifies what might otherwise seem like completely different statistical procedures.</p>
<p>Fourth, the unified approach provides greater flexibility for analyzing complex data. Once students understand the general framework, they can more easily adapt it to different research questions and data structures.</p>
<p>This approach emphasizes conceptual understanding over rote memorization, making statistics more accessible and easier to apply correctly in research contexts.</p>
</div>
</section><section id="conclusion-the-power-of-unified-statistical-thinking" class="level2"><h2 class="anchored" data-anchor-id="conclusion-the-power-of-unified-statistical-thinking">Conclusion: The Power of Unified Statistical Thinking</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>The general linear model provides a common language for statistics</li>
<li>This unified framework builds intuition and transferable knowledge</li>
<li>Focus on understanding the model, not memorizing procedures</li>
<li>Simplify teaching and learning of statistics</li>
<li>Apply this unified thinking to your own statistical analyses</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img src="https://media.giphy.com/media/l0IylSajlbPRFxH8Y/giphy.gif" class="img-fluid"></p>
</div>
</div>
<div class="notes">
<p>In conclusion, the general linear model provides a powerful, unified framework for statistical analysis. By understanding that many common statistical tests are special cases of the linear model, we gain a deeper and more coherent understanding of statistics.</p>
<p>This unified framework offers several important benefits:</p>
<p>First, it provides a common language for discussing different statistical procedures. Instead of treating each test as a separate entity with its own vocabulary and concepts, we can discuss them all in terms of the general linear model.</p>
<p>Second, it builds intuition and transferable knowledge. Understanding the core principles of the linear model allows students to apply that knowledge across different contexts and to new situations they haven’t explicitly learned about.</p>
<p>Third, it shifts the focus from memorizing procedures to understanding the underlying model. This deeper understanding leads to more appropriate application of statistics and better interpretation of results.</p>
<p>Fourth, it simplifies both teaching and learning statistics. Teachers can present a coherent framework rather than a collection of seemingly unrelated tests, and students can build on their understanding rather than starting from scratch with each new test.</p>
<p>Finally, I encourage you to apply this unified thinking in your own statistical work. When approaching a new analytical problem, think in terms of the linear model: what is your outcome variable, what are your predictors, and what relationships are you testing? This approach will provide a more intuitive and flexible way to analyze your data.</p>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/drandrewmitchell\.com\/BSSC0021-Code");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../Week7/2-content.html" class="pagination-link" aria-label="ANOVA as a Linear Model">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">ANOVA as a Linear Model</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>