<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Data Visualization – BSSC0021</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Week3/notes.html" rel="next">
<link href="../notes.html" rel="prev">
<link href="../assets/stat_bear.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-e1ddcd3af2ec4b57c0db9e416c98bed6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-sm " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../assets/stat_bear.png" alt="BSSC0021" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../office-hours.html"> 
<span class="menu-text">Office Hours</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../notes.html" aria-current="page"> 
<span class="menu-text">Weekly Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides.html"> 
<span class="menu-text">Lecture Slides</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://rstudio.data-science.rc.ucl.ac.uk/" title="" class="quarto-navigation-tool px-1" aria-label="RStudio"><i class="bi bi-r-circle-fill"></i></a>
    <a href="https://github.com/MitchellAcoustics/BSSC0021-Code" title="" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Data Visualization</h1>
        </a>     
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week2/notes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Data Visualization</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 3</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 1: Introduction to Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/02-rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability Rules and Classical Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/03-empirical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Determining Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/04-conditional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conditional Probability and Independence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/05-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayes’ Rule and Learning from Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/06-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week3/07-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 2: Statistical Sampling</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 4</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week4/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference and Hypothesis Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week4/01-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week4/02-samp-dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling Distribution of the Mean</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week4/04-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week4/05-hyptest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hypothesis Testing</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Sampling Exercise &amp; Quarto</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/sampling-exercise-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling Exercise Review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/sampling-exercise-walkthrough.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/sampling-exercise-extended.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analyzing Salaries in the AI Job Market</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 5</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Communicating Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/1-carbonbrief.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Misleading Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/3-analysis-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Data Analysis Workflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week5/4-assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formative Assessment: Deceptive Visualization</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 6</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week6/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation and Regression</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 7</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week7/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression and ANOVA as Linear Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week7/1-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The General Linear Model as a Foundation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week7/2-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA as a Linear Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Week7/3-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Common Statistical Tests as Linear Models</span></a>
  </div>
</li>
      </ul>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#this-weeks-lecture" id="toc-this-weeks-lecture" class="nav-link active" data-scroll-target="#this-weeks-lecture">This week’s lecture:</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#the-grammar-of-graphics" id="toc-the-grammar-of-graphics" class="nav-link" data-scroll-target="#the-grammar-of-graphics">The Grammar of Graphics</a></li>
  <li>
<a href="#the-grammar-of-graphics-1" id="toc-the-grammar-of-graphics-1" class="nav-link" data-scroll-target="#the-grammar-of-graphics-1">The Grammar of Graphics</a>
  <ul class="collapse">
<li><a href="#a-plot-can-be-decomposed-into-three-primary-elements" id="toc-a-plot-can-be-decomposed-into-three-primary-elements" class="nav-link" data-scroll-target="#a-plot-can-be-decomposed-into-three-primary-elements">A plot can be decomposed into three primary elements</a></li>
  </ul>
</li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a></li>
  <li>
<a href="#getting-started-1" id="toc-getting-started-1" class="nav-link" data-scroll-target="#getting-started-1">Getting Started</a>
  <ul class="collapse">
<li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  </ul>
</li>
  <li>
<a href="#getting-started-2" id="toc-getting-started-2" class="nav-link" data-scroll-target="#getting-started-2">Getting Started</a>
  <ul class="collapse">
<li><a href="#loading-the-data" id="toc-loading-the-data" class="nav-link" data-scroll-target="#loading-the-data">Loading the Data</a></li>
  </ul>
</li>
  <li>
<a href="#getting-started-3" id="toc-getting-started-3" class="nav-link" data-scroll-target="#getting-started-3">Getting Started</a>
  <ul class="collapse">
<li><a href="#getting-help" id="toc-getting-help" class="nav-link" data-scroll-target="#getting-help">Getting help</a></li>
  </ul>
</li>
  <li>
<a href="#the-grammar-of-graphics-2" id="toc-the-grammar-of-graphics-2" class="nav-link" data-scroll-target="#the-grammar-of-graphics-2">The Grammar of Graphics</a>
  <ul class="collapse">
<li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The Data</a></li>
  </ul>
</li>
  <li>
<a href="#the-grammar-of-graphics-3" id="toc-the-grammar-of-graphics-3" class="nav-link" data-scroll-target="#the-grammar-of-graphics-3">The Grammar of Graphics</a>
  <ul class="collapse">
<li><a href="#the-data-1" id="toc-the-data-1" class="nav-link" data-scroll-target="#the-data-1">The Data</a></li>
  </ul>
</li>
  <li><a href="#formulating-our-research-questions" id="toc-formulating-our-research-questions" class="nav-link" data-scroll-target="#formulating-our-research-questions">Formulating our Research Question(s)</a></li>
  <li>
<a href="#building-up-a-plot" id="toc-building-up-a-plot" class="nav-link" data-scroll-target="#building-up-a-plot">Building up a plot</a>
  <ul class="collapse">
<li><a href="#creating-a-ggplot" id="toc-creating-a-ggplot" class="nav-link" data-scroll-target="#creating-a-ggplot">Creating a ggplot</a></li>
  </ul>
</li>
  <li><a href="#building-up-a-plot-1" id="toc-building-up-a-plot-1" class="nav-link" data-scroll-target="#building-up-a-plot-1">Building up a plot</a></li>
  <li>
<a href="#the-grammar-of-graphics-4" id="toc-the-grammar-of-graphics-4" class="nav-link" data-scroll-target="#the-grammar-of-graphics-4">The Grammar of Graphics</a>
  <ul class="collapse">
<li><a href="#aesthetics" id="toc-aesthetics" class="nav-link" data-scroll-target="#aesthetics">Aesthetics</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-2" id="toc-building-up-a-plot-2" class="nav-link" data-scroll-target="#building-up-a-plot-2">Building up a plot</a>
  <ul class="collapse">
<li><a href="#aesthetic-mappings" id="toc-aesthetic-mappings" class="nav-link" data-scroll-target="#aesthetic-mappings">Aesthetic mappings</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-3" id="toc-building-up-a-plot-3" class="nav-link" data-scroll-target="#building-up-a-plot-3">Building up a plot</a>
  <ul class="collapse">
<li><a href="#adding-layers" id="toc-adding-layers" class="nav-link" data-scroll-target="#adding-layers">Adding layers</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-4" id="toc-building-up-a-plot-4" class="nav-link" data-scroll-target="#building-up-a-plot-4">Building up a plot</a>
  <ul class="collapse">
<li><a href="#add-a-scatter-point-layer-to-the-plot" id="toc-add-a-scatter-point-layer-to-the-plot" class="nav-link" data-scroll-target="#add-a-scatter-point-layer-to-the-plot">Add a scatter point layer to the plot:</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-5" id="toc-building-up-a-plot-5" class="nav-link" data-scroll-target="#building-up-a-plot-5">Building up a plot</a>
  <ul class="collapse">
<li><a href="#adding-aesthetics" id="toc-adding-aesthetics" class="nav-link" data-scroll-target="#adding-aesthetics">Adding aesthetics</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-6" id="toc-building-up-a-plot-6" class="nav-link" data-scroll-target="#building-up-a-plot-6">Building up a plot</a>
  <ul class="collapse">
<li><a href="#add-a-trend-line-to-see-the-relationship-more-clearly-using-geom_smooth" id="toc-add-a-trend-line-to-see-the-relationship-more-clearly-using-geom_smooth" class="nav-link" data-scroll-target="#add-a-trend-line-to-see-the-relationship-more-clearly-using-geom_smooth">Add a trend line to see the relationship more clearly using <code>geom_smooth()</code></a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-7" id="toc-building-up-a-plot-7" class="nav-link" data-scroll-target="#building-up-a-plot-7">Building up a plot</a>
  <ul class="collapse">
<li><a href="#adding-smooth-curves" id="toc-adding-smooth-curves" class="nav-link" data-scroll-target="#adding-smooth-curves">Adding smooth curves</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-8" id="toc-building-up-a-plot-8" class="nav-link" data-scroll-target="#building-up-a-plot-8">Building up a plot</a>
  <ul class="collapse">
<li><a href="#adding-smooth-curves-1" id="toc-adding-smooth-curves-1" class="nav-link" data-scroll-target="#adding-smooth-curves-1">Adding smooth curves</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-9" id="toc-building-up-a-plot-9" class="nav-link" data-scroll-target="#building-up-a-plot-9">Building up a plot</a>
  <ul class="collapse">
<li><a href="#adding-smooth-curves-2" id="toc-adding-smooth-curves-2" class="nav-link" data-scroll-target="#adding-smooth-curves-2">Adding smooth curves</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-plots" id="toc-building-up-plots" class="nav-link" data-scroll-target="#building-up-plots">Building up plots</a>
  <ul class="collapse">
<li><a href="#global-vs-local-aesthetics" id="toc-global-vs-local-aesthetics" class="nav-link" data-scroll-target="#global-vs-local-aesthetics">Global vs Local aesthetics</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-10" id="toc-building-up-a-plot-10" class="nav-link" data-scroll-target="#building-up-a-plot-10">Building up a plot</a>
  <ul class="collapse">
<li><a href="#other-aesthetics---shapes" id="toc-other-aesthetics---shapes" class="nav-link" data-scroll-target="#other-aesthetics---shapes">Other aesthetics - shapes</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-11" id="toc-building-up-a-plot-11" class="nav-link" data-scroll-target="#building-up-a-plot-11">Building up a plot</a>
  <ul class="collapse">
<li><a href="#final-touches" id="toc-final-touches" class="nav-link" data-scroll-target="#final-touches">Final touches</a></li>
  </ul>
</li>
  <li>
<a href="#building-up-a-plot-12" id="toc-building-up-a-plot-12" class="nav-link" data-scroll-target="#building-up-a-plot-12">Building up a plot</a>
  <ul class="collapse">
<li><a href="#we-can-now-add-this-information-to-our-plot" id="toc-we-can-now-add-this-information-to-our-plot" class="nav-link" data-scroll-target="#we-can-now-add-this-information-to-our-plot">We can now add this information to our plot</a></li>
  </ul>
</li>
  <li><a href="#some-notes-on-ggplot-calls" id="toc-some-notes-on-ggplot-calls" class="nav-link" data-scroll-target="#some-notes-on-ggplot-calls">Some notes on <code>ggplot()</code> calls</a></li>
  <li><a href="#some-notes-on-ggplot-calls-1" id="toc-some-notes-on-ggplot-calls-1" class="nav-link" data-scroll-target="#some-notes-on-ggplot-calls-1">Some notes on <code>ggplot()</code> calls</a></li>
  <li><a href="#some-notes-on-ggplot-calls-2" id="toc-some-notes-on-ggplot-calls-2" class="nav-link" data-scroll-target="#some-notes-on-ggplot-calls-2">Some notes on <code>ggplot()</code> calls</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#thats-it" id="toc-thats-it" class="nav-link" data-scroll-target="#thats-it">That’s it!</a></li>
  <li>
<a href="#continuous-module-dialogue" id="toc-continuous-module-dialogue" class="nav-link" data-scroll-target="#continuous-module-dialogue">Continuous Module Dialogue</a>
  <ul class="collapse">
<li><a href="#menti-survey" id="toc-menti-survey" class="nav-link" data-scroll-target="#menti-survey">Menti Survey</a></li>
  </ul>
</li>
  <li><a href="#visualizing-distributions" id="toc-visualizing-distributions" class="nav-link" data-scroll-target="#visualizing-distributions">Visualizing distributions</a></li>
  <li>
<a href="#visualizing-distributions-1" id="toc-visualizing-distributions-1" class="nav-link" data-scroll-target="#visualizing-distributions-1">Visualizing distributions</a>
  <ul class="collapse">
<li><a href="#categorical-variables" id="toc-categorical-variables" class="nav-link" data-scroll-target="#categorical-variables">Categorical variables</a></li>
  </ul>
</li>
  <li>
<a href="#visualizing-distributions-2" id="toc-visualizing-distributions-2" class="nav-link" data-scroll-target="#visualizing-distributions-2">Visualizing distributions</a>
  <ul class="collapse">
<li><a href="#improving-categorical-plots" id="toc-improving-categorical-plots" class="nav-link" data-scroll-target="#improving-categorical-plots">Improving categorical plots</a></li>
  </ul>
</li>
  <li>
<a href="#visualizing-distributions-3" id="toc-visualizing-distributions-3" class="nav-link" data-scroll-target="#visualizing-distributions-3">Visualizing distributions</a>
  <ul class="collapse">
<li><a href="#numerical-variables" id="toc-numerical-variables" class="nav-link" data-scroll-target="#numerical-variables">Numerical variables</a></li>
  </ul>
</li>
  <li>
<a href="#visualizing-distributions-4" id="toc-visualizing-distributions-4" class="nav-link" data-scroll-target="#visualizing-distributions-4">Visualizing distributions</a>
  <ul class="collapse">
<li><a href="#exploring-binwidth" id="toc-exploring-binwidth" class="nav-link" data-scroll-target="#exploring-binwidth">Exploring binwidth</a></li>
  </ul>
</li>
  <li>
<a href="#visualizing-distributions-5" id="toc-visualizing-distributions-5" class="nav-link" data-scroll-target="#visualizing-distributions-5">Visualizing distributions</a>
  <ul class="collapse">
<li><a href="#density-plots" id="toc-density-plots" class="nav-link" data-scroll-target="#density-plots">Density plots</a></li>
  </ul>
</li>
  <li>
<a href="#visualizing-relationships" id="toc-visualizing-relationships" class="nav-link" data-scroll-target="#visualizing-relationships">Visualizing relationships</a>
  <ul class="collapse">
<li><a href="#numerical-and-categorical-variables" id="toc-numerical-and-categorical-variables" class="nav-link" data-scroll-target="#numerical-and-categorical-variables">Numerical and categorical variables</a></li>
  </ul>
</li>
  <li>
<a href="#visualizing-relationships-1" id="toc-visualizing-relationships-1" class="nav-link" data-scroll-target="#visualizing-relationships-1">Visualizing relationships</a>
  <ul class="collapse">
<li><a href="#alternative-views" id="toc-alternative-views" class="nav-link" data-scroll-target="#alternative-views">Alternative views</a></li>
  </ul>
</li>
  <li>
<a href="#visualizing-relationships-2" id="toc-visualizing-relationships-2" class="nav-link" data-scroll-target="#visualizing-relationships-2">Visualizing relationships</a>
  <ul class="collapse">
<li><a href="#two-categorical-variables" id="toc-two-categorical-variables" class="nav-link" data-scroll-target="#two-categorical-variables">Two categorical variables</a></li>
  </ul>
</li>
  <li>
<a href="#visualizing-relationships-3" id="toc-visualizing-relationships-3" class="nav-link" data-scroll-target="#visualizing-relationships-3">Visualizing relationships</a>
  <ul class="collapse">
<li><a href="#three-or-more-variables" id="toc-three-or-more-variables" class="nav-link" data-scroll-target="#three-or-more-variables">Three or more variables</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">Data Visualization</h1>
<p class="subtitle lead">The Grammar of Graphics with <code>ggplot2</code></p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="this-weeks-lecture" class="level2"><h2 class="anchored" data-anchor-id="this-weeks-lecture">This week’s lecture:</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><a href="lecture.html" class="btn btn-outline-primary" role="button" data-toggle="tooltip" title="Click the button to view the slides online.">Slides</a></p>
</div><div class="column" style="width:50%;">
<p><a class="btn btn-outline-primary" role="button" href="lecture.pdf" download="Week2-slides.pdf"> Download PDF Slides </a></p>
</div>
</div>
<p>or continue on to the next pages for lecture notes.</p>
</section><section id="introduction" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<blockquote class="blockquote">
<p>“The simple graph has brought more information to the data analyst’s mind than any other device.” — John Tukey</p>
</blockquote>
<p>R has several systems for making graphs, but <code>ggplot2</code> is one of the most elegant and most versatile.</p>
<p><code>ggplot2</code> implements the <em>grammar of graphics</em>, a coherent system for describing and building graphs. With <code>ggplot2</code>, you can do more and faster by learning one system and applying it in many places.</p>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>This presentation is based on the <a href="https://r4ds.had.co.nz/data-visualisation.html">Data Visualization</a> chapter of the <a href="https://r4ds.had.co.nz/">R for Data Science</a> book by Hadley Wickham and Garrett Grolemund.</p>
</div></div><hr>
<p>In this tutorial, we will create this plot:</p>
<div class="cell" data-autorun="true">
<pre class="{webr}"><code>#| echo: false
#| autorun: true
#| fig-width: 10
#| fig-height: 5
intro_p &lt;- penguins |&gt;
  drop_na() |&gt;
  ggplot(mapping = aes(x = flipper_length_mm, y = body_mass_g)) +
  geom_point(mapping = aes(color = species, shape = species)) +
  geom_smooth(method = "lm", formula = y ~ x) +
  labs(
    title = "Body Mass and Flipper Length",
    subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
    x = "Flipper Length (mm)",
    y = "Body Mass (g)",
    color = "Species",
    shape = "Species"
  )

intro_p</code></pre>
</div>
</section><section id="the-grammar-of-graphics" class="level2"><h2 class="anchored" data-anchor-id="the-grammar-of-graphics">The Grammar of Graphics</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>In 1999, a statistician named Leland Wilkinson published the first edition of what has been the most influential work in data visualization, The Grammar of Graphics.</p>
<p>The most complete implementation of the grammar is found in an R package called <code>ggplot2</code> by Hadley Wickham.</p>
</div><div class="column" style="width:50%;">
<!-- ![The Grammar of Graphics, Wilkinson (1999)](img/grammar-graphics.png) -->
</div>
</div>
</section><section id="the-grammar-of-graphics-1" class="level2"><h2 class="anchored" data-anchor-id="the-grammar-of-graphics-1">The Grammar of Graphics</h2>
<section id="a-plot-can-be-decomposed-into-three-primary-elements" class="level3"><h3 class="anchored" data-anchor-id="a-plot-can-be-decomposed-into-three-primary-elements">A plot can be decomposed into three primary elements</h3>
<p><span class="fragment semi-fade-out" data-fragment-index="1">1. the <strong>data</strong></span></p>
<p><span class="fragment fade-in-then-semi-out" data-fragment-index="1">2. the <strong>aesthetic mapping</strong> of the variables in the data to visual cues</span></p>
<p><span class="fragment fade-in-then-semi-out" data-fragment-index="2">3. the <strong>geometry</strong> used to encode the observations on the plot.</span></p>
<hr>
<p><img src="img/graphics-layers.png" class="img-fluid"></p>
</section></section><section id="getting-started" class="level2"><h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>Throughout this lecture, we will be writing code together inside this webpage.<br></p>
<div class="cell" data-exercise="getting-started" data-min-lines="5">
<pre class="{webr}"><code>#| exercise: getting-started
#| min-lines: 5
</code></pre>
</div>
<div class="hint" data-exercise="getting-started">
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>You can type code into the cells and run them by clicking the “Run” button.</p>
<div class="cell">
<pre class="{webr}"><code>2 + 3
</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="getting-started-1" class="level2"><h2 class="anchored" data-anchor-id="getting-started-1">Getting Started</h2>
<section id="packages" class="level3"><h3 class="anchored" data-anchor-id="packages">Packages</h3>
<div class="colums">
<div class="column" style="width:50%;">
<p>We begin by loading the <code>tidyverse</code> and <code>ggplot2</code> packages.<br></p>
<p>We almost always begin our work by loading the tidyverse package. Note that the terms “package” and “library” are used interchangeably but that there is no package() function. To load a package, you need to use library().</p>
</div>
<div class="column center" style="width:50%;">
<div class="cell" data-min-lines="3">
<pre class="{webr}"><code>#| label: getting-started
#| min-lines: 3

# Load the libraries
</code></pre>
</div>
</div>
</div>
</section></section><section id="getting-started-2" class="level2"><h2 class="anchored" data-anchor-id="getting-started-2">Getting Started</h2>
<section id="loading-the-data" class="level3"><h3 class="anchored" data-anchor-id="loading-the-data">Loading the Data</h3>
<div class="columns">
<div class="column center" style="width:50%;">
<p>Load the <code>palmerpenguins</code> package using library().</p>
<p>This package contains the <code>penguins</code> dataset, which we will use for this tutorial.</p>
</div><div class="column" style="width:50%;">
<div class="cell" data-autorun="false" data-min-lines="2">
<pre class="{webr}"><code><a href="https://allisonhorst.github.io/palmerpenguins/">#| autorun: false
#| min-lines: 2
library(palmerpenguins)
</a></code></pre>
</div>
</div>
</div>
</section></section><section id="getting-started-3" class="level2"><h2 class="anchored" data-anchor-id="getting-started-3">Getting Started</h2>
<section id="getting-help" class="level3"><h3 class="anchored" data-anchor-id="getting-help">Getting help</h3>
<div class="columns">
<div class="column" style="width:40%;">
<p>If you are unsure about how to use a function, you can use the <code>?</code> operator to get help.</p>
<p>For a data package like <code>palmerpenguins</code>, you can use <code>?penguins</code> to get help on the dataset.</p>
</div><div class="column" style="width:60%;">
<div class="cell">
<pre class="{webr}"><code>?penguins
</code></pre>
</div>
</div>
</div>
</section></section><section id="the-grammar-of-graphics-2" class="level2"><h2 class="anchored" data-anchor-id="the-grammar-of-graphics-2">The Grammar of Graphics</h2>
<section id="the-data" class="level3"><h3 class="anchored" data-anchor-id="the-data">The Data</h3>
<p><span class="fragment semi-fade-out" data-fragment-index="1">- A <strong>variable</strong> is a quantity, quality, or property that you can measure.</span></p>
<p><span class="fragment fade-in-then-semi-out" data-fragment-index="1">- A <strong>value</strong> is the state of a variable when you measure it. The value of a variable may change from measurement to measurement.</span></p>
<p><span class="fragment fade-in-then-semi-out" data-fragment-index="2">- An <strong>observation</strong> is a set of measurements made under similar conditions. An observation will contain several values, each associated with a different variable. We’ll sometimes refer to an observation as a data point.</span></p>
<p><span class="fragment fade-in-then-semi-out" data-fragment-index="3">- <strong>Tabular data</strong> is a set of values, each associated with a variable and an observation. Tabular data is <em>tidy</em> if each value is placed in its own “cell”, each variable in its own column, and each observation in its own row.</span></p>
</section></section><section id="the-grammar-of-graphics-3" class="level2"><h2 class="anchored" data-anchor-id="the-grammar-of-graphics-3">The Grammar of Graphics</h2>
<section id="the-data-1" class="level3"><h3 class="anchored" data-anchor-id="the-data-1">The Data</h3>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li>
<code>species</code>: a penguin’s species (Adelie, Chinstrap, or Gentoo).</li>
<li>
<code>flipper_length_mm</code>: length of a penguin’s flipper, in millimeters.</li>
<li>
<code>body_mass_g</code>: body mass of a penguin, in grams.</li>
</ul>
</div><div class="column" style="width:70%;">
<div class="r-stack">
<div class="fragment fade-out" data-fragment-index="1">
<div class="cell">
<pre class="{webr}"><code>penguins
</code></pre>
</div>
</div>
<div class="fragment" data-fragment-index="1">
<div class="cell" data-autorun="true">
<pre class="{webr}"><code>#| fig-width: 6.5
#| fig-height: 4.8
#| warning: false
#| echo: false
#| autorun: true
ggplot(
  data = penguins,
  mapping = aes(x = bill_length_mm, y = bill_depth_mm, color = species)
) +
  geom_point()</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="formulating-our-research-questions" class="level2"><h2 class="anchored" data-anchor-id="formulating-our-research-questions">Formulating our Research Question(s)</h2>
<div class="incremental">
<ul class="incremental">
<li>Do penguins with longer flippers weigh more or less than penguins with shorter flippers? You probably already have an answer, but try to make your answer precise.</li>
<li>What does the relationship between flipper length and body mass look like? Is it positive? Negative? Linear? Nonlinear?</li>
<li>Does the relationship vary by the species of the penguin? How about by the island where the penguin lives?</li>
</ul>
</div>
</section><section id="building-up-a-plot" class="level2"><h2 class="anchored" data-anchor-id="building-up-a-plot">Building up a plot</h2>
<section id="creating-a-ggplot" class="level3"><h3 class="anchored" data-anchor-id="creating-a-ggplot">Creating a ggplot</h3>
<div class="columns">
<div class="column" style="width:40%;">
<p>With <strong>ggplot2</strong>, you begin a plot with the function <code>ggplot()</code>, defining a plot object that you then add layers to.<br></p>
<p>The first argument of <code>ggplot()</code> is the dataset to use in the graph and so <code>ggplot(data = penguins)</code> creates an empty graph that is primed to display the penguins data, but since we haven’t told it how to visualize it yet, for now it’s empty.<br></p>
</div><div class="column" style="width:60%;">
<div class="cell" data-exercise="empty-plot">
<pre class="{webr}"><code>#| exercise: empty-plot
</code></pre>
</div>
<div class="hint" data-exercise="empty-plot">
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell" data-edit="false">
<pre class="{webr}"><code>#| edit: false
ggplot(data = penguins)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<p>input <code>ggplot(data = penguins)</code></p>
</div>
</section></section><section id="building-up-a-plot-1" class="level2"><h2 class="anchored" data-anchor-id="building-up-a-plot-1">Building up a plot</h2>
<p>This is not a very exciting plot, but you can think of it like an empty canvas you’ll paint the remaining layers of your plot onto.<br></p>
<p>Next, we need to tell <code>ggplot()</code> how the information from our data will be visually represented. The mapping argument of the <code>ggplot()</code> function defines how variables in your dataset are mapped to visual properties (<strong>aesthetics</strong>) of your plot.<br></p>
<p>. . .</p>
<p>For now, we will only map flipper length to the <code>x</code> aesthetic and body mass to the <code>y</code> aesthetic.</p>
</section><section id="the-grammar-of-graphics-4" class="level2"><h2 class="anchored" data-anchor-id="the-grammar-of-graphics-4">The Grammar of Graphics</h2>
<section id="aesthetics" class="level3"><h3 class="anchored" data-anchor-id="aesthetics">Aesthetics</h3>
<p><img src="img/aesthetics.png" class="img-fluid"></p>
</section></section><section id="building-up-a-plot-2" class="level2"><h2 class="anchored" data-anchor-id="building-up-a-plot-2">Building up a plot</h2>
<section id="aesthetic-mappings" class="level3"><h3 class="anchored" data-anchor-id="aesthetic-mappings">Aesthetic mappings</h3>
<div class="columns">
<div class="column" style="width:40%;">
<p>The mapping argument is always defined in the <code>aes()</code> function, and the <code>x</code> and <code>y</code> arguments of <code>aes()</code> specify which variables to map to the <code>x</code> and <code>y</code> axes.<br></p>
<p>For now, we will only map flipper length to the <code>x</code> aesthetic and body mass to the <code>y</code> aesthetic. <strong>ggplot2</strong> looks for the mapped variables in the <code>data</code> argument, in this case, <code>penguins</code>.</p>
</div><div class="column" style="width:60%;">
<div class="cell" data-exercise="aesthetic-mappings" data-autorun="false">
<pre class="{webr}"><code>#| exercise: aesthetic-mappings
#| autorun: false
ggplot(
  data = penguins,
  mapping = ______________________
)</code></pre>
</div>
<div class="hint" data-exercise="aesthetic-mappings">
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell" data-edit="false" data-autorun="false">
<pre class="{webr}"><code>#| edit: false
#| autorun: false
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<p>add <code>mapping = aes(x = flipper_length_mm, y = body_mass_g)</code></p>
<p>Our empty canvas now has more structure – it’s clear where flipper lengths will be displayed (on the x-axis) and where body masses will be displayed (on the y-axis). But the penguins themselves are not yet on the plot. This is because we have not yet articulated, in our code, how to represent the observations from our data frame on our plot.</p>
</div>
</section></section><section id="building-up-a-plot-3" class="level2"><h2 class="anchored" data-anchor-id="building-up-a-plot-3">Building up a plot</h2>
<section id="adding-layers" class="level3"><h3 class="anchored" data-anchor-id="adding-layers">Adding layers</h3>
<p>We need to define a <strong>geom</strong>: the geometrical object that a plot uses to represent data. These geometric objects are made available in <strong>ggplot2</strong> with functions that start with <code>geom_</code>.<br></p>
<p>People often describe plots by the type of geom that the plot uses:</p>
<div class="incremental">
<ul class="incremental">
<li>bar charts use bar geoms (<code>geom_bar()</code>),</li>
<li>line charts use line geoms (<code>geom_line()</code>),</li>
<li>boxplots use boxplot geoms (<code>geom_boxplot()</code>),</li>
<li>scatterplots use point geoms (<code>geom_point()</code>), and so on.</li>
</ul>
</div>
<p>The function <code>geom_point()</code> adds a <strong>layer</strong> of points to your plot, which creates a scatterplot.</p>
</section></section><section id="building-up-a-plot-4" class="level2"><h2 class="anchored" data-anchor-id="building-up-a-plot-4">Building up a plot</h2>
<section id="add-a-scatter-point-layer-to-the-plot" class="level3"><h3 class="anchored" data-anchor-id="add-a-scatter-point-layer-to-the-plot">Add a scatter point layer to the plot:</h3>
<div class="cell" data-exercise="geom-point">
<pre class="{webr}"><code>#| exercise: geom-point
#| fig-width: 9
#| fig-height: 5
#| fig-alt: |
#|   A scatterplot of flipper length (x-axis) and body mass (y-axis) for penguins. The plot
#|   displays a positive, linear, and relative strong relationship between these two variables.
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  __________________________
</code></pre>
</div>
<div class="proof solution" data-exercise="geom-point">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell" data-edit="false">
<pre class="{webr}"><code>#| edit: false
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point()</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<p>add <code>+ geom_point()</code></p>
<p>Now we have a scatterplot of flipper length (x-axis) and body mass (y-axis) for penguins. The plot displays a positive, linear, and relative strong relationship between these two variables.</p>
<p>Before we add more layers to this plot, let’s pause for a moment and review the warning message we got:</p>
<p>We’re seeing this message because there are two penguins in our dataset with missing body mass and/or flipper length values and ggplot2 has no way of representing them on the plot without both of these values. Like R, ggplot2 subscribes to the philosophy that missing values should never silently go missing. This type of warning is probably one of the most common types of warnings you will see when working with real data – missing values are a very common issue and you’ll learn more about them later. For the remaining plots we will suppress this warning so it’s not printed alongside every single plot we make.</p>
</div>
</section></section><section id="building-up-a-plot-5" class="level2"><h2 class="anchored" data-anchor-id="building-up-a-plot-5">Building up a plot</h2>
<section id="adding-aesthetics" class="level3"><h3 class="anchored" data-anchor-id="adding-aesthetics">Adding aesthetics</h3>
<div class="columns">
<div class="column" style="width:40%;">
<div class="r-stack">
<div class="fragment fade-out smaller">
<p>It’s always a good idea to be skeptical of any apparent relationship between two variables and ask if there may be other variables that explain or change the nature of this apparent relationship.</p>
</div>
<div class="fragment smaller">
<p>For example, does the relationship between flipper length and body mass differ by species?</p>
<p>When exploring relationships between variables, it’s important to consider other variables that might affect the relationship. Let’s incorporate <code>species</code> into our plot using color:</p>
</div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-exercise="add-color">
<pre class="{webr}"><code>#| exercise: add-color
#| warning: false
#| fig-alt: |
#|   A scatterplot of body mass vs. flipper length of penguins, with points
#|   colored by species.
ggplot(
  data = penguins,
  mapping = aes(
    x = flipper_length_mm,
    y = body_mass_g,
    ______________________
  )
) +
  geom_point()</code></pre>
</div>
<div class="hint" data-exercise="add-color">
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell" data-edit="false">
<pre class="{webr}"><code>#| edit: false
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g, color = species)
) +
  geom_point()</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<p>Scatterplots are useful for displaying the relationship between two numerical variables, but it’s always a good idea to be skeptical of any apparent relationship between two variables and ask if there may be other variables that explain or change the nature of this apparent relationship.</p>
<p>For example, does the relationship between flipper length and body mass differ by species? Let’s incorporate species into our plot and see if this reveals any additional insights into the apparent relationship between these variables. We will do this by representing species with different colored points.</p>
<p>To achieve this, will we need to modify the aesthetic or the geom? If you guessed “in the aesthetic mapping, inside of <code>aes()</code>”, you’re already getting the hang of creating data visualizations with ggplot2! And if not, don’t worry.</p>
<p>Add <code>color = species</code> to the aesthetic mapping. This tells ggplot2 to color the points by species.</p>
<p>When we map a categorical variable to an aesthetic, ggplot2 automatically: - Assigns a unique value to each level (here, a unique color for each species) - Adds a legend explaining the mapping</p>
</div>
</section></section><section id="building-up-a-plot-6" class="level2"><h2 class="anchored" data-anchor-id="building-up-a-plot-6">Building up a plot</h2>
<section id="add-a-trend-line-to-see-the-relationship-more-clearly-using-geom_smooth" class="level3"><h3 class="anchored" data-anchor-id="add-a-trend-line-to-see-the-relationship-more-clearly-using-geom_smooth">Add a trend line to see the relationship more clearly using <code>geom_smooth()</code>
</h3>
<div class="cell" data-exercise="add-lm">
<pre class="{webr}"><code>#| exercise: add-lm
#| warning: false
#| fig-alt: |
#|   A scatterplot of body mass vs. flipper length with trend lines by species.
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g, color = species)
) +
  geom_point() +
  _______________</code></pre>
</div>
<div class="hint" data-exercise="add-lm">
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Add a trendline (<code>geom_smooth(method = "lm")</code>) layer to the plot.</p>
<div class="cell" data-edit="false">
<pre class="{webr}"><code>#| edit: false
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g, color = species)
) +
  geom_point() +
  geom_smooth(method = "lm")</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<p>Now let’s add one more layer: a smooth curve displaying the relationship between body mass and flipper length. Before you proceed, refer back to the code above, and think about how we can add this to our existing plot.</p>
<p>Since this is a new geometric object representing our data, we will add a new geom as a layer on top of our point geom: <code>geom_smooth()</code>. And we will specify that we want to draw the line of best fit based on a linear model with <code>method = "lm"</code>.</p>
<p>Add <code>geom_smooth(method = "lm")</code> to the plot.</p>
<p>The method = “lm” argument tells geom_smooth() to use a linear model. Notice how the color aesthetic is inherited by both geoms, creating separate trend lines for each species.</p>
</div>
</section></section><section id="building-up-a-plot-7" class="level2" data-auto-animate="true"><h2 data-auto-animate="true" class="anchored" data-anchor-id="building-up-a-plot-7">Building up a plot</h2>
<section id="adding-smooth-curves" class="level3"><h3 class="anchored" data-anchor-id="adding-smooth-curves">Adding smooth curves</h3>
<p>It’s important to recognise how the <strong>color aesthetic</strong> is inherited by both <strong>geoms</strong>, creating separate trend lines for each species.<br></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="at">data =</span> penguins,</span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> body_mass_g, <span class="at">color =</span> species)</span>
<span id="cb19-4"><a href="#cb19-4"></a>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="notes">
<p>We have successfully added lines, but this plot doesn’t look like our ultimate goal plot, which only has one line for the entire dataset as opposed to separate lines for each of the penguin species.</p>
<p>When aesthetic mappings are defined in <code>ggplot()</code>, at the <em>global</em> level, they’re passed down to each of the subsequent geom layers of the plot. However, each geom function in ggplot2 can also take a <code>mapping</code> argument, which allows for aesthetic mappings at the <em>local</em> level that are added to those inherited from the global level. Since we want points to be colored based on species but don’t want the lines to be separated out for them, we should specify <code>color = species</code> for <code>geom_point()</code> only.</p>
</div>
</section></section><section id="building-up-a-plot-8" class="level2" data-auto-animate="true"><h2 data-auto-animate="true" class="anchored" data-anchor-id="building-up-a-plot-8">Building up a plot</h2>
<section id="adding-smooth-curves-1" class="level3"><h3 class="anchored" data-anchor-id="adding-smooth-curves-1">Adding smooth curves</h3>
<p>It’s important to recognise how the <strong>color aesthetic</strong> is inherited by both <strong>geoms</strong>, creating separate trend lines for each species.<br></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="at">data =</span> penguins,</span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> body_mass_g, </span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="at">color =</span> species)</span>
<span id="cb20-5"><a href="#cb20-5"></a>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>  <span class="fu">geom_point</span>( <span class="sc">&lt;</span><span class="at">color =</span> species<span class="sc">&gt;</span> ) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section><section id="building-up-a-plot-9" class="level2" data-auto-animate="true"><h2 data-auto-animate="true" class="anchored" data-anchor-id="building-up-a-plot-9">Building up a plot</h2>
<section id="adding-smooth-curves-2" class="level3"><h3 class="anchored" data-anchor-id="adding-smooth-curves-2">Adding smooth curves</h3>
<p>It’s important to recognise how the <strong>color aesthetic</strong> is inherited by both <strong>geoms</strong>, creating separate trend lines for each species.<br></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="at">data =</span> penguins,</span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> body_mass_g, </span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="at">color =</span> species)</span>
<span id="cb21-5"><a href="#cb21-5"></a>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="sc">&lt;</span><span class="at">color =</span> species<span class="sc">&gt;</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pay attention to how the aesthetic mappings propagate through the layers of the plot.</p>
<p>This can be useful for creating complex plots with multiple layers, but it can also lead to unexpected results if you’re not careful.</p>
</section></section><section id="building-up-plots" class="level2"><h2 class="anchored" data-anchor-id="building-up-plots">Building up plots</h2>
<section id="global-vs-local-aesthetics" class="level3"><h3 class="anchored" data-anchor-id="global-vs-local-aesthetics">Global vs Local aesthetics</h3>
<div class="columns">
<div class="column" style="width:40%;">
<p>In the previous plot, the color aesthetic was defined in the global mapping. This means that it applies to all geoms in the plot.</p>
<p>To get a single trend line while keeping colored points, we move the color aesthetic to <code>geom_point()</code>:</p>
</div><div class="column" style="width:60%;">
<div class="cell" data-exercise="local-aesthetics">
<pre class="{webr}"><code>#| exercise: local-aesthetics
#| warning: false
#| fig-alt: |
#|   A scatterplot with colored points by species and a single trend line.
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(___________________________) +
  geom_smooth(method = "lm")</code></pre>
</div>
<div class="hint" data-exercise="local-aesthetics">
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell" data-edit="false">
<pre class="{webr}"><code>#| edit: false
#| warning: false
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(mapping = aes(color = species)) +
  geom_smooth(method = "lm")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<p>Aesthetic mappings can be defined at the global level (in ggplot()) or at the local level (in individual geoms). Local aesthetics override global ones.</p>
<p>Voila! We have something that looks very much like our ultimate goal, though it’s not yet perfect. We still need to use different shapes for each species of penguins and improve labels.</p>
<p>It’s generally not a good idea to represent information using only colors on a plot, as people perceive colors differently due to color blindness or other color vision differences. Therefore, in addition to color, we can also map <code>species</code> to the <code>shape</code> aesthetic.</p>
</div>
</section></section><section id="building-up-a-plot-10" class="level2"><h2 class="anchored" data-anchor-id="building-up-a-plot-10">Building up a plot</h2>
<section id="other-aesthetics---shapes" class="level3"><h3 class="anchored" data-anchor-id="other-aesthetics---shapes">Other aesthetics - shapes</h3>
<div class="r-stack">
<div class="fragment fade-out">
<p>In addition to color, we can also map out variables to other aesthetic elements.</p>
<p>Here, we map <code>species</code> to the <code>shape</code> aesthetic.</p>
</div>
<div class="fragment absolute" data-top="100" width="95%">
<div class="cell" data-exercise="add-shape">
<pre class="{webr}"><code>#| exercise: add-shape
#| warning: false
#| fig-width: 10
#| fig-height: 5
#| fig-alt: |
#|   A scatterplot of body mass vs. flipper length of penguins. Overlaid 
#|   on the scatterplot is a single line of best fit displaying the 
#|   relationship between these variables for each species (Adelie, 
#|   Chinstrap, and Gentoo). Different penguin species are plotted in 
#|   different colors and shapes for the points only.
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(
    mapping = aes(color = species, ____________________)
    ) +
  geom_smooth(method = "lm")</code></pre>
</div>
<div class="hint" data-exercise="add-shape">
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell" data-edit="false">
<pre class="{webr}"><code>#| edit: false
#| warning: false
#| fig-width: 10
#| fig-height: 5
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(mapping = aes(color = species, shape = species)) +
  geom_smooth(method = "lm")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<p>It’s generally not a good idea to represent information using only colors on a plot, as people perceive colors differently due to color blindness or other color vision differences. Therefore, in addition to color, we can also map <code>species</code> to the <code>shape</code> aesthetic.</p>
</div>
</section></section><section id="building-up-a-plot-11" class="level2" data-auto-animate="true"><h2 data-auto-animate="true" class="anchored" data-anchor-id="building-up-a-plot-11">Building up a plot</h2>
<section id="final-touches" class="level3"><h3 class="anchored" data-anchor-id="final-touches">Final touches</h3>
<p>The <strong>data portions</strong> of our plot are now complete. But data visualization is not just about the data – it’s also about the <strong>visual elements</strong> that make the plot accessible and informative.<br></p>
<p>We also need the plot itself to communicate:</p>
<div class="incremental">
<ul class="incremental">
<li>What the <strong>plot is about</strong> (title)</li>
<li>What the <strong>axes represent</strong>, including <em>units</em> (labels)</li>
<li>What the colors and shapes <strong>represent</strong> (legends)</li>
<li>Additional context such as the source of the data (subtitle or caption)</li>
</ul>
</div>
</section></section><section id="building-up-a-plot-12" class="level2" data-auto-animate="true"><h2 data-auto-animate="true" class="anchored" data-anchor-id="building-up-a-plot-12">Building up a plot</h2>
<section id="we-can-now-add-this-information-to-our-plot" class="level3"><h3 class="anchored" data-anchor-id="we-can-now-add-this-information-to-our-plot">We can now add this information to our plot</h3>
<div class="cell" data-exercise="final-plot">
<pre class="{webr}"><code>#| warning: false
#| exercise: final-plot
#| fig-width: 12
#| fig-height: 6
#| fig-alt: |
#|   The final version of our plot with proper labels and both color and shape aesthetics.
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(aes(color = species, shape = species)) +
  geom_smooth(method = "lm") +
  labs(
    _____ = ________________, 
    color = "Species",
    shape = "Species"
  ) +
  scale_color_colorblind()</code></pre>
</div>
<div class="hint" data-exercise="final-plot">
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell" data-edit="false">
<pre class="{webr}"><code>#| edit: false
#| warning: false
ggplot(
  data = penguins,
  mapping = aes(x = flipper_length_mm, y = body_mass_g)
) +
  geom_point(aes(color = species, shape = species)) +
  geom_smooth(method = "lm") +
  labs(
    title = "Body Mass and Flipper Length",
    subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
    x = "Flipper Length (mm)", 
    y = "Body Mass (g)",
    color = "Species", 
    shape = "Species"
  ) +
  scale_color_colorblind()</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<p>To add:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>title <span class="ot">=</span> <span class="st">"Body Mass and Flipper Length"</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>subtitle <span class="ot">=</span> <span class="st">"Dimensions for Adelie, Chinstrap, and Gentoo Penguins"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="st">"Flipper Length (mm)"</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="st">"Body Mass (g)"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>color <span class="ot">=</span> <span class="st">"Species"</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>shape <span class="ot">=</span> <span class="st">"Species"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>And finally, we can improve the labels of our plot using the <code>labs()</code> function in a new layer. Some of the arguments to <code>labs()</code> might be self explanatory:</p>
<ul>
<li>
<code>title</code> adds a title and <code>subtitle</code> adds a subtitle to the plot</li>
</ul>
<p>Other arguments match the aesthetic mappings:</p>
<ul>
<li>
<code>x</code> is the x-axis label</li>
<li>
<code>y</code> is the y-axis label</li>
<li>
<code>color</code> and <code>shape</code> define the label for the legend.</li>
</ul>
<p>In addition, we can improve the color palette to be colorblind safe with the <code>scale_color_colorblind()</code> function from the ggthemes package.</p>
</div>
</section></section><section id="some-notes-on-ggplot-calls" class="level2"><h2 class="anchored" data-anchor-id="some-notes-on-ggplot-calls">Some notes on <code>ggplot()</code> calls</h2>
<div class="r-stack">
<div class="fragment fade-out center" data-fragment-index="1">
<p>So far, we’ve written the code in a very explicit way, with each argument named. This is a good practice when you’re learning, but it can be a bit verbose.<br></p>
</div>
<div class="fragment" data-fragment-index="1">
<p>Typically, the first one or two arguments to a function are so important that you should know them by heart. The first two arguments to <code>ggplot()</code> are <span class="fragment highlight-blue" data-fragment-index="2"><strong>data</strong></span> and <span class="fragment highlight-blue" data-fragment-index="2"><strong>mapping</strong></span>.</p>
<div class="r-stack">
<p><span class="fragment fade-out" data-fragment-index="4">You’ll often see them left out. This is true for other functions as well.</span></p>
<p><span class="fragment" data-fragment-index="4">When leaving the names out, the order of the arguments matters.</span></p>
</div>
<p><br></p>
</div>
</div>
<div class="r-stack">
<div class="fragment fade-out absolute" data-fragment-index="2" data-top="300" width="100%">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">penguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment fade-in-then-out absolute" data-fragment-index="2" data-top="300" width="100%">
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="at">data =</span> penguins,</span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> body_mass_g)</span>
<span id="cb30-4"><a href="#cb30-4"></a>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment fade-in-then-semi-out absolute" data-fragment-index="3" data-top="300" width="100%">
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> body_mass_g)) <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment absolute" data-fragment-index="4" data-top="340" width="100%">
<div class="cell" data-edit="false">
<pre class="{webr}"><code>#| edit: false
?ggplot</code></pre>
</div>
</div>
</section><section id="some-notes-on-ggplot-calls-1" class="level2" data-auto-animate="true"><h2 data-auto-animate="true" class="anchored" data-anchor-id="some-notes-on-ggplot-calls-1">Some notes on <code>ggplot()</code> calls</h2>
<p>In the future, you’ll also learn about the pipe, <code>|&gt;</code>, which operates similarly to the <code>+</code> operator in ggplot2.</p>
<p>It lets you chain together a series of operations, passing the output of one function to the input of the next.<br></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> body_mass_g)) <span class="sc">+</span> </span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="some-notes-on-ggplot-calls-2" class="level2" data-auto-animate="true"><h2 data-auto-animate="true" class="anchored" data-anchor-id="some-notes-on-ggplot-calls-2">Some notes on <code>ggplot()</code> calls</h2>
<p>In the future, you’ll also learn about the pipe, <code>|&gt;</code>, which operates similarly to the <code>+</code> operator in ggplot2.</p>
<p>It lets you chain together a series of operations, passing the output of one function to the input of the next.<br></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="fu">ggplot</span>(<span class="sc">&lt;</span>penguins<span class="sc">&gt;</span>, <span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> body_mass_g)) <span class="sc">+</span> </span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="fragment">
<p>Don’t worry if you don’t understand this yet. It’s just a sneak peek at what’s to come.</p>
</div>
</section><section id="summary" class="level2"><h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>The basic idea that underpins ggplot2: <strong>a visualization is a mapping from variables in your data to aesthetic properties like position, color, size and shape.</strong></p>
<ul>
<li>The grammar of graphics provides a systematic way to build visualizations</li>
<li>Start with data and aesthetic mappings</li>
<li>Add layers with geoms</li>
<li>Use different geoms for different types of variables</li>
<li>Enhance plots with labels, colors, and facets</li>
<li>Make sure your plots are clear and honest</li>
</ul>
<div class="notes">
<p>Key takeaways: - Build plots layer by layer - Choose appropriate visualizations for your variable types - Consider your audience when making design choices - Use aesthetics and facets to show additional variables - Always aim for clear and accessible visualizations</p>
</div>
</section><section id="thats-it" class="level2"><h2 class="anchored" data-anchor-id="thats-it">That’s it!</h2>
<p>With our remaining time, I’d like you to practice with <code>ggplot2</code> using the DataAnalytics exercise. You should have already installed DataAnalytics with:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"antoinevernet/DataAnalytics"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can then run the following code to get started:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>learnr<span class="sc">::</span><span class="fu">run_tutorial</span>(<span class="st">"02-Visualisation"</span>, <span class="at">package =</span>&nbsp;<span class="st">"DataAnalytics"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="continuous-module-dialogue" class="level2"><h2 class="anchored" data-anchor-id="continuous-module-dialogue">Continuous Module Dialogue</h2>
<section id="menti-survey" class="level3"><h3 class="anchored" data-anchor-id="menti-survey">Menti Survey</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/mentimeter_qr_code.png" class="img-fluid figure-img"></p>
<figcaption><a href="https://www.menti.com/al7gkr8qhntz">https://www.menti.com/al7gkr8qhntz</a></figcaption></figure>
</div>
</section></section><section id="visualizing-distributions" class="level2"><h2 class="anchored" data-anchor-id="visualizing-distributions">Visualizing distributions</h2>
<p>The following are some additional slides on dealing with other data types and visualizing distributions in <code>ggplot2</code>. Explore them at your own pace.</p>
</section><section id="visualizing-distributions-1" class="level2"><h2 class="anchored" data-anchor-id="visualizing-distributions-1">Visualizing distributions</h2>
<section id="categorical-variables" class="level3"><h3 class="anchored" data-anchor-id="categorical-variables">Categorical variables</h3>
<p>For categorical variables like <code>species</code>, we use bar charts:</p>
<div class="cell">
<pre class="{webr}"><code>#| fig-alt: |
#|   A bar chart showing the frequency of each penguin species.
ggplot(penguins, aes(x = species)) +
  geom_bar()</code></pre>
</div>
<div class="notes">
<p>A bar chart shows: - Categories on one axis - Counts (frequencies) on the other axis - Height of bars represents number of observations in each category</p>
</div>
</section></section><section id="visualizing-distributions-2" class="level2" data-visibility="hidden"><h2 data-visibility="hidden" class="anchored" data-anchor-id="visualizing-distributions-2">Visualizing distributions</h2>
<section id="improving-categorical-plots" class="level3"><h3 class="anchored" data-anchor-id="improving-categorical-plots">Improving categorical plots</h3>
<p>We can reorder bars by frequency for better visualization:</p>
<div class="cell">
<pre class="{webr}"><code>#| fig-alt: |
#|   A bar chart with species ordered by frequency.
ggplot(penguins, aes(x = fct_infreq(species))) +
  geom_bar()</code></pre>
</div>
<div class="notes">
<p>fct_infreq() is a function from forcats package that reorders factor levels by their frequencies. This makes the plot easier to read and interpret patterns.</p>
</div>
</section></section><section id="visualizing-distributions-3" class="level2"><h2 class="anchored" data-anchor-id="visualizing-distributions-3">Visualizing distributions</h2>
<section id="numerical-variables" class="level3"><h3 class="anchored" data-anchor-id="numerical-variables">Numerical variables</h3>
<p>For numerical variables like <code>body_mass_g</code>, we use histograms:</p>
<div class="cell">
<pre class="{webr}"><code>#| warning: false
#| fig-alt: |
#|   A histogram showing the distribution of penguin body mass.
ggplot(penguins, aes(x = body_mass_g)) +
  geom_histogram(binwidth = 200)</code></pre>
</div>
<div class="notes">
<p>A histogram: - Divides the x-axis into bins - Height shows number of observations in each bin - binwidth controls the size of the bins - Different binwidths can reveal different patterns</p>
</div>
</section></section><section id="visualizing-distributions-4" class="level2"><h2 class="anchored" data-anchor-id="visualizing-distributions-4">Visualizing distributions</h2>
<section id="exploring-binwidth" class="level3"><h3 class="anchored" data-anchor-id="exploring-binwidth">Exploring binwidth</h3>
<p>The choice of binwidth affects what patterns we can see:</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre class="{webr}"><code>#| warning: false
#| layout-ncol: 2
#| fig-width: 5
#| fig-alt: |
#|   Two histograms with different binwidths showing how binwidth affects visualization.
ggplot(penguins, aes(x = body_mass_g)) +
  geom_histogram(binwidth = 20)

ggplot(penguins, aes(x = body_mass_g)) +
  geom_histogram(binwidth = 2000)</code></pre>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>Too small binwidth: too many bars, noisy pattern</li>
<li>Too large binwidth: too few bars, loses detail</li>
<li>Need to experiment to find the right balance</li>
</ul>
</div>
</section></section><section id="visualizing-distributions-5" class="level2"><h2 class="anchored" data-anchor-id="visualizing-distributions-5">Visualizing distributions</h2>
<section id="density-plots" class="level3"><h3 class="anchored" data-anchor-id="density-plots">Density plots</h3>
<p>An alternative to histograms is the density plot:</p>
<div class="cell">
<pre class="{webr}"><code>#| fig-alt: |
#|   A density plot showing the distribution of penguin body mass.

ggplot(penguins, aes(x = body_mass_g)) +
  geom_density()</code></pre>
</div>
<div class="notes">
<p>Density plots: - Show the shape of the distribution smoothly - Easier to compare multiple groups - Like a smoothed histogram - Think of it as draping a string over a histogram</p>
</div>
</section></section><section id="visualizing-relationships" class="level2"><h2 class="anchored" data-anchor-id="visualizing-relationships">Visualizing relationships</h2>
<section id="numerical-and-categorical-variables" class="level3"><h3 class="anchored" data-anchor-id="numerical-and-categorical-variables">Numerical and categorical variables</h3>
<p>To compare a numerical variable across categories, use boxplots:</p>
<div class="cell">
<pre class="{webr}"><code>#| warning: false
#| fig-alt: |
#|   Box plots showing body mass distribution by species.
ggplot(penguins, aes(x = species, y = body_mass_g)) +
  geom_boxplot()</code></pre>
</div>
<div class="notes">
<p>A boxplot shows: - Median (middle line) - IQR (box) - Whiskers (extend to most extreme non-outlier points) - Individual points for outliers</p>
</div>
</section></section><section id="visualizing-relationships-1" class="level2"><h2 class="anchored" data-anchor-id="visualizing-relationships-1">Visualizing relationships</h2>
<section id="alternative-views" class="level3"><h3 class="anchored" data-anchor-id="alternative-views">Alternative views</h3>
<p>We can also use density plots to compare distributions:</p>
<div class="cell">
<pre class="{webr}"><code>#| warning: false
#| fig-alt: |
#|   Density plots of body mass by species.
ggplot(penguins, aes(x = body_mass_g, color = species, fill = species)) +
  geom_density(alpha = 0.5)</code></pre>
</div>
<div class="notes">
<ul>
<li>color and fill aesthetics distinguish species</li>
<li>alpha controls transparency</li>
<li>Overlapping distributions show how groups compare</li>
</ul>
</div>
</section></section><section id="visualizing-relationships-2" class="level2"><h2 class="anchored" data-anchor-id="visualizing-relationships-2">Visualizing relationships</h2>
<section id="two-categorical-variables" class="level3"><h3 class="anchored" data-anchor-id="two-categorical-variables">Two categorical variables</h3>
<p>For two categorical variables, use stacked bar plots:</p>
<div class="cell">
<pre class="{webr}"><code>#| fig-alt: |
#|   A stacked bar plot showing species distribution across islands.
ggplot(penguins, aes(x = island, fill = species)) +
  geom_bar(position = "fill")</code></pre>
</div>
<div class="notes">
<p>position = “fill”: - Standardizes bars to same height - Shows proportions instead of counts - Better for comparing distributions across groups</p>
</div>
</section></section><section id="visualizing-relationships-3" class="level2"><h2 class="anchored" data-anchor-id="visualizing-relationships-3">Visualizing relationships</h2>
<section id="three-or-more-variables" class="level3"><h3 class="anchored" data-anchor-id="three-or-more-variables">Three or more variables</h3>
<p>Use facets to split plots by a categorical variable:</p>
<div class="cell">
<pre class="{webr}"><code>#| warning: false
#| fig-width: 10
#| fig-height: 3
#| fig-alt: |
#|   A faceted plot showing the relationship between body mass and flipper length for each island.

ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +
  geom_point(aes(color = species, shape = species)) +
  facet_wrap(~island)</code></pre>
</div>
<div class="notes">
<p>facet_wrap(): - Creates separate plots for each category - Maintains same scales across plots - Useful for seeing patterns within groups - Alternative to mapping variables to aesthetics</p>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/drandrewmitchell\.com\/BSSC0021-Code");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../notes.html" class="pagination-link" aria-label="Notes">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Notes</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Week3/notes.html" class="pagination-link" aria-label="Week 3">
        <span class="nav-page-text">Week 3</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>